#LyX 2.4 created this file. For more info see https://www.lyx.org/
\lyxformat 620
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\sloppy
% Any additional packages needed should be included after jmlr2e.
% Note that jmlr2e.sty includes epsfig, amssymb, natbib and graphicx,
% and defines many common macros, such as 'proof' and 'example'.
%
% It also sets the bibliographystyle to plainnat; for more information on
% natbib citation styles, see the natbib documentation, a copy of which
% is archived at http://www.jmlr.org/format/natbib.pdf

% Available options for package jmlr2e are:
%
%   - abbrvbib : use abbrvnat for the bibliography style
%   - nohyperref : do not load the hyperref package
%   - preprint : remove JMLR specific information from the template,
%         useful for example for posting to preprint servers.
%
% Example of using the package with custom options:
%\usepackage[abbrvbib, preprint]{jmlr2e}
\usepackage{jmlr2e}
\usepackage{amsfonts}\usepackage{subfigure}
\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{enumerate}
\usepackage{xcolor}
\usepackage{abbe}
\usepackage{colortbl}\usepackage{array}% for professional tables
\usepackage{tikz}
\usetikzlibrary{arrows.meta,shapes.geometric,positioning}
\definecolor{Gray}{gray}{0.9} %Table cell color

% Definitions of handy macros can go here
\def\mcp#1{\textcolor{red}{#1}}
\def\wy#1{\textcolor{blue}{#1}}

\newcommand{\independent}{\protect\mathpalette{\protect\independenT}{\perp}}
\def\independenT#1#2{\mathrel{\rlap{$#1#2$}\mkern2mu{#1#2}}}
\global\long\def\CE#1#2{\EE\left[\left.#1\right|#2\right]}%
\global\long\def\CP#1#2{\PP\left(\left.#1\right|#2\right)}%
\global\long\def\abs#1{\left|#1\right|}%
\global\long\def\norm#1{\left\Vert #1\right\Vert }%
\global\long\def\Indicator#1{\mathbb{I}\left(#1\right)}%

\global\long\def\Pcal{\mathcal{P}}%
\global\long\def\mS{\mathcal{S}}%
\global\long\def\mD{\mathcal{D}}%
\global\long\def\mA{\mathcal{A}}%
\global\long\def\mM{\mathcal{M}}%

\global\long\def\Reward#1#2{Y_{#1,#2}}%
\global\long\def\Error#1#2{\eta_{#1,#2}}%
\global\long\def\Tildepi#1#2{\tilde{\pi}_{#1,#2}}%
\global\long\def\ZZ#1#2{\mathbf{Z}_{#1,#2}}%
\global\long\def\Newreward#1#2{W_{#1,#2}}%
\global\long\def\NewDRY#1#2#3{W_{#2,#3}^{DR(#1)}}%
\global\long\def\Newcontext#1#2{Z_{#1,#2}}%
\global\long\def\SelectionP#1#2{\pi_{#1,#2}}%
\global\long\def\Newaction#1{\tilde{a}_{#1}}%
\global\long\def\NewProb#1#2{\phi_{#1,#2}}%
\global\long\def\Estimator#1{\widehat{\theta}_{#1}}%
\global\long\def\DREstimator#1{\widehat{\theta}_{#1}^{DR}}%
\global\long\def\IPW#1{\widehat{\theta}_{#1}^{IPW}}%
\global\long\def\Impute#1{\check{\theta}_{#1}}%
\global\long\def\DRY#1#2#3{Y_{#2,#3}^{DR(#1)}}%
\global\long\def\TildeY#1#2#3{\tilde{Y}_{#2,#3}^{(#1)}}%
\global\long\def\DRerror#1#2#3{\eta_{#2,#3}^{DR(#1)}}%
\global\long\def\TildeError#1#2#3{\tilde{\eta}_{#2,#3}^{(#1)}}%
\global\long\def\Selfbound#1#2{\beta_{#1}(#2)}%
\global\long\def\Predbound#1#2#3{\gamma_{#1,#2}(#3)}%
\global\long\def\Diff#1#2{\Delta_{#1,#2}}%
\global\long\def\Action#1{a_{#1}}%
\global\long\def\PseudoAction#1#2{\mathfrak{\mathfrak{I}}_{#2}^{(#1)}}%
\global\long\def\History#1{\mathcal{H}_{#1}}%
\global\long\def\XX#1#2{\boldsymbol{X}_{#1,#2}}%
\global\long\def\Optimalarm#1{a_{#1}^{*}}%
\global\long\def\Maxeigen#1{\lambda_{\max}\!\left(#1\right)}%
\global\long\def\Mineigen#1{\lambda_{\min}\!\left(#1\right)}%
\global\long\def\Trace#1{\text{Tr}\left(#1\right)}%
\global\long\def\SetofContexts#1{\mathcal{X}_{#1}}%
\global\long\def\Ridgebeta#1{\widehat{\theta}_{#1}^{ridge}}%
\global\long\def\Order#1{\langle#1\rangle}%
\global\long\def\AdmitRound#1{\tau(#1)}%
\global\long\def\Regret#1{regret\ensuremath{(#1)}}%
\global\long\def\Sampledreward#1#2#3{\tilde{Y}_{#2,#3}^{(#1)}}%
\global\long\def\Sampledparameter#1#2#3{\tilde{\theta}_{#2,#3}^{(#1)}}%
\global\long\def\Mod{\text{mod}}%

% Heading arguments are {volume}{year}{pages}{date submitted}{date published}{paper id}{author-full-names}

\usepackage{lastpage}
\jmlrheading{24}{2025}{1-\pageref{LastPage}}{6/25}{??/??}{21-0000}{Wonyoung Kim}

% Short headings should be running head and authors last names

\ShortHeadings{Adaptive Data Augmentation for  Thompson Sampling}{Kim}
\firstpageno{1}

\newtheorem{thm}{\protect\theoremname}\newtheorem{lem}[thm]{\protect\lemmaname}\newtheorem{prop}[thm]{\protect\propositionname}

\usepackage{babel}
\providecommand{\lemmaname}{Lemma}
\providecommand{\propositionname}{Proposition}
\providecommand{\remarkname}{Remark}
\providecommand{\theoremname}{Theorem}
\end_preamble
\use_default_options false
\begin_modules
theorems-ams
\end_modules
\maintain_unincluded_children no
\language english
\language_package default
\inputencoding utf8
\fontencoding default
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_roman_osf false
\font_sans_osf false
\font_typewriter_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 11
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 0
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_formatted_ref 0
\use_minted 0
\use_lineno 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle default
\tablestyle default
\tracking_changes false
\output_changes false
\change_bars false
\postpone_fragile_content true
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\docbook_table_output 0
\docbook_mathml_prefix 1
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% COMMON ABBRVS 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% bold alphabet 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\ab}{\mathbf{a}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\bb}{\mathbf{b}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\cb}{\mathbf{c}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\db}{\mathbf{d}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\eb}{\mathbf{e}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\fb}{\mathbf{f}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\gb}{\mathbf{g}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\hb}{\mathbf{h}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\ib}{\mathbf{i}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\jb}{\mathbf{j}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\kb}{\mathbf{k}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\lb}{\mathbf{l}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\mb}{\mathbf{m}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\nb}{\mathbf{n}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\ob}{\mathbf{o}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\pb}{\mathbf{p}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\qb}{\mathbf{q}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\rb}{\mathbf{r}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\sb}{\mathbf{s}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\tb}{\mathbf{t}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\ub}{\mathbf{u}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\vb}{\mathbf{v}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\wb}{\mathbf{w}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\xb}{\mathbf{x}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\yb}{\mathbf{y}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\zb}{\mathbf{z}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Ab}{\mathbf{A}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Bb}{\mathbf{B}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Cb}{\mathbf{C}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Db}{\mathbf{D}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Eb}{\mathbf{E}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Fb}{\mathbf{F}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Gb}{\mathbf{G}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Hb}{\mathbf{H}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Ib}{\mathbf{I}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Jb}{\mathbf{J}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Kb}{\mathbf{K}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Lb}{\mathbf{L}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Mb}{\mathbf{M}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Nb}{\mathbf{N}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Ob}{\mathbf{O}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Pb}{\mathbf{P}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Qb}{\mathbf{Q}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Rb}{\mathbf{R}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Sb}{\mathbf{S}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Tb}{\mathbf{T}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Ub}{\mathbf{U}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Vb}{\mathbf{V}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Wb}{\mathbf{W}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Xb}{\mathbf{X}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Yb}{\mathbf{Y}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Zb}{\mathbf{Z}}
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% calligraphic fonts
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\Acal}{\mathcal{A}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Bcal}{\mathcal{B}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Ccal}{\mathcal{C}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Dcal}{\mathcal{D}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Ecal}{\mathcal{E}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Fcal}{\mathcal{F}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Gcal}{\mathcal{G}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Hcal}{\mathcal{H}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Ical}{\mathcal{I}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Jcal}{\mathcal{J}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Kcal}{\mathcal{K}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Lcal}{\mathcal{L}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Mcal}{\mathcal{M}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Ncal}{\mathcal{N}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Ocal}{\mathcal{O}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Pcal}{\mathcal{P}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Qcal}{\mathcal{Q}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Rcal}{\mathcal{R}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Scal}{\mathcal{S}}
{\mathcal{S}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Tcal}{\mathcal{T}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Ucal}{\mathcal{U}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Vcal}{\mathcal{V}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Wcal}{\mathcal{W}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Xcal}{\mathcal{X}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Ycal}{\mathcal{Y}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Zcal}{\mathcal{Z}}
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%%%%%%%% Widely accepted definitions %%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\BB}{\mathbb{B}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Ball
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\CC}{\mathbb{C}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Complex numbers
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\EE}{\mathbb{E}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Expectation
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\VV}{\mathbb{V}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Variance
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\II}{\mathbb{I}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Indicator
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\KK}{\mathbb{K}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Arbitrary field
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\LL}{\mathbb{L}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Loss
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\MM}{\mathbb{M}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Median
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\NN}{\mathbb{N}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Natural numbers
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\PP}{\mathbb{P}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Probability
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\QQ}{\mathbb{Q}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Rationals
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\RR}{\mathbb{R}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Real numbers
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\ZZ}{\mathbb{Z}}
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% Integers
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\XX}{\mathbb{X}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\YY}{\mathbb{Y}}
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%%%%%%%% bold greek letters %%%%%%%%%%
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset FormulaMacro
\newcommand{\alphab}{\boldsymbol{\alpha}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\betab}{\boldsymbol{\beta}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Sigmab}{\boldsymbol{\Sigma}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Omegab}{\boldsymbol{\Omega}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\omegab}{\boldsymbol{\omega}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Gammab}{\boldsymbol{\Gamma}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Psib}{\boldsymbol{\Psi}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Thetab}{\boldsymbol{\Theta}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\thetab}{\boldsymbol{\theta}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\taub}{\boldsymbol{\tau}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\epsilonb}{\boldsymbol{\epsilon}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\etab}{\boldsymbol{\eta}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\xib}{\boldsymbol{\xi}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\gammab}{\boldsymbol{\gamma}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\deltab}{\boldsymbol{\delta}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\Deltab}{\boldsymbol{\Delta}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\mub}{\boldsymbol{\mu}}
\end_inset

 
\begin_inset FormulaMacro
\newcommand{\rhob}{\boldsymbol{\rho}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\vPhib}{\boldsymbol{\varPhi}}
{\boldsymbol{\varPhi}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\abs}[1]{\left|\!#1\!\right|}
{\left|#1\right|}
\end_inset


\begin_inset FormulaMacro
\newcommand{\CE}[2]{\EE\!\left[\left.#1\right|#2\right]}
{\EE\left[\left.#1\right|#2\right]}
\end_inset


\begin_inset FormulaMacro
\newcommand{\norm}[1]{\left\Vert #1\right\Vert }
{\left\Vert #1\right\Vert }
\end_inset


\end_layout

\begin_layout Title
Adaptive Data Augmentation for Thompson Sampling
\end_layout

\begin_layout Author
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
name{W}
\end_layout

\end_inset

onyoung Kim 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
email
\end_layout

\end_inset

 wyk7@cau.ac.kr 
\begin_inset Newline newline
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
addr
\end_layout

\end_inset

 Department of Artificial Intelligence
\begin_inset Newline newline
\end_inset

 Chung-Ang University 
\begin_inset Newline newline
\end_inset

 Seoul,
 Republic of Korea 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
AND         
\end_layout

\begin_layout Plain Layout

%
\backslash
name Myunghee Cho Paik 
\end_layout

\begin_layout Plain Layout

%
\backslash
email myungheechopaik@snu.ac.kr 
\backslash

\backslash
 
\end_layout

\begin_layout Plain Layout

%
\backslash
addr Department of Statistics 
\backslash

\backslash
         
\end_layout

\begin_layout Plain Layout

%Seoul National University
\backslash

\backslash
         
\end_layout

\begin_layout Plain Layout

%Seoul 08826,
 Republic of Korea}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
editor
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

My editor
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Abstract
In linear contextual bandits,
 the objective is to select actions that maximize cumulative rewards,
 modeled as a linear function with unknown parameters.
 Although Thompson Sampling performs well empirically,
 it does not achieve optimal regret bounds.
 This paper proposes a nearly minimax optimal Thompson Sampling for linear contextual bandits by developing a novel estimator with the adaptive data augmentation and coupling of the hypothetical samples that are designed for efficient parameter learning.
 The proposed estimator accurately predicts rewards for all arms without relying on assumptions for the context distribution.
 Empirical results show robust performance and significant improvement over existing methods.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{keywords}
\end_layout

\end_inset

 Thompson Sampling,
 minimax optimal regret bound,
 hypothetical bandit problem,
 adaptive data augmentation,
 coupling.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{keywords}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%-----------------------
\end_layout

\begin_layout Plain Layout

% 1.
 Introduction
\end_layout

\begin_layout Plain Layout

%-----------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Linear contextual bandits (LinCB) provide a simple yet powerful framework for sequential decision-making.
 At each decision epoch,
 an agent selects an action from a set of context vectors to maximize cumulative rewards,
 assumed to be linear functions of the chosen contexts.
 A special case is the multi-armed bandit (MAB) problem,
 in which the contexts are standard Euclidean basis vectors.
 Compared with more complex models—
such as generalized linear models or deep neural networks,
 which demand substantial updates at each step—
LinCB and MAB offer high computational efficiency.
 LinCB methods have been widely applied in fields such as e-commerce personalization 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{hsu2020recommending}
\end_layout

\end_inset

,
 revenue management 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{ferreira2018online}
\end_layout

\end_inset

,
 clinical trials 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{murphy2005experimental}
\end_layout

\end_inset

,
 political-science experiments 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{offer2021adaptive}
\end_layout

\end_inset

,
 and A/B testing in marketing 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{satyal2018ab}
\end_layout

\end_inset

,
 as comprehensively surveyed by 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{bouneffouf2020survey}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Two primary algorithmic paradigms dominate the LinCB literature:
 the upper-confidence-bound algorithm (
\family typewriter
LinUCB
\family default
) and Thompson Sampling (
\family typewriter
LinTS
\family default
).
 
\family typewriter
LinUCB
\family default
 selects the arm that maximizes an upper confidence bound on its reward,
 whereas 
\family typewriter
LinTS
\family default
 samples a parameter from its posterior (or estimated) distribution and selects the arm with the highest sampled reward.
 Empirical studies 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{chapelle2011}
\end_layout

\end_inset

 consistently demonstrate the superiority of 
\family typewriter
LinTS
\family default
 over 
\family typewriter
LinUCB
\family default
 across various scenarios.
 Nevertheless,
 a significant gap persists between the best-known frequentist regret bound for 
\family typewriter
LinTS
\family default
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{abeille2017linear}
\end_layout

\end_inset

 and the minimax lower bound 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{lattimore2020bandit}
\end_layout

\end_inset

.
 Closing this gap is challenging due to the selective reward observation inherent in 
\family typewriter
LinTS
\family default
,
 complicating variance control for optimal-arm reward estimation.
\end_layout

\begin_layout Standard
Recent LinCB research has leveraged advanced statistical methodologies to enhance algorithmic performance and theoretical guarantees.
 Techniques from high-dimensional parameter estimation 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{buhlmann2011statistics}
\end_layout

\end_inset

,
 optimal experimental design 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{smith1918standard,guttorp2009karl}
\end_layout

\end_inset

,
 and Bayesian optimization 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{mockus2005bayesian}
\end_layout

\end_inset

 have been adapted to bandit settings.
 More recently,
 missing-data techniques have been employed to bridge the regret-bound gap by estimating missing rewards as though rewards from all arms were observed at every round 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{kim2019doubly,kim2021doubly}
\end_layout

\end_inset

.
 Unlike conventional estimators,
 which reduce errors solely for selected arms,
 these methods seek convergence across all arms.
 However,
 their reliance on inverse-probability weighting introduces variance that scales with the number of arms.
 To mitigate this,
 existing methods typically impose restrictive assumptions—
such as independent-and-identically-distributed (IID) contexts or particular diversity conditions—
limiting broader applicability.
 Addressing this limitation necessitates resolving open issues in both missing-data and LinCB literatures.
\end_layout

\begin_layout Standard
This paper addresses this critical gap by introducing a novel estimation approach capable of learning rewards for all arms without relying on IID or diversity conditions.
 In the proposed framework,
 a hypothetical bandit problem tailored for efficient parameter estimation is constructed.
 This hypothetical setup employs a set of orthogonal basis vectors,
 preserving the covariance structure of the original contexts while significantly reducing the effective number of arms.
 By coupling the hypothetical and original problems,
 the resulting estimator achieves a novel self-normalized bound based on a Gram matrix encompassing contexts from all arms,
 including unselected ones.
 The proposed algorithm,
 equipped with this new estimator,
 attains the minimax optimal regret bound up to logarithmic factors without restrictive assumptions on context distributions.
\end_layout

\begin_layout Standard
The remainder of the paper is organized as follows.
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:related_works"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 reviews relevant literature on LinCB,
 highlighting key contributions of the proposed approach.
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:LinCB"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 presents the formal problem formulation.
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:proposed_method"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 details the proposed estimator and algorithm along with their theoretical justifications.
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:regret_analysis"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 provides a rigorous regret analysis,
 establishing the minimax optimality of the proposed method.
 Finally,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:experiment"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 empirically validates the effectiveness of the proposed algorithm across various benchmark scenarios.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

% 2.
 Related Literature
\end_layout

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Related Literature
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:related_works"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement t
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Comparison of regret bounds and assumptions on 
\family typewriter
LinTS
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "tab:ts-regret-comparison"

\end_inset

 
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features booktabs="true" tabularvalignment="middle">
<column alignment="none" valignment="top" special="@{}l">
<column alignment="center" valignment="top">
<column alignment="none" valignment="top" special="c@{}">
<row>
<cell alignment="none" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Reference
\series default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Regret bound
\series default
 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Key assumptions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{agrawal2013thompson}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\tilde{O}\bigl(d^{3/2}\sqrt{T}\bigr)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Normalized contexts 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[2pt] 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{abeille2017linear}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\tilde{O}\bigl(d^{3/2}\sqrt{T}\bigr)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Normalized contexts 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[2pt] 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{dimakopoulou2019balanced}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\tilde{O}\bigl(d^{3/2}\sqrt{T}\bigr)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Normalized contexts 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[2pt] 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2021doubly}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\tilde{O}\bigl(d\sqrt{T}\bigr)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IID contexts from special distributions 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[2pt] 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{huix2023tight}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\tilde{O}\bigl(d\sqrt{T}\bigr)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian prior on parameter 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[2pt] 
\series bold
This work
\series default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\tilde{O}\bigl(d\sqrt{T}\bigr)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bounded contexts 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The linear contextual bandit (LinCB) problem,
 introduced by 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{abe1999associative}
\end_layout

\end_inset

,
 has become foundational in sequential decision-making tasks.
 Two predominant algorithmic frameworks for LinCB are the upper-confidence-bound algorithm (
\family typewriter
LinUCB
\family default
) and Thompson Sampling (
\family typewriter
LinTS
\family default
).
 
\family typewriter
LinUCB
\family default
,
 which selects the arm maximizing the upper confidence bound of its reward,
 has been extensively studied 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{auer2002using,
 dani2008stochastic,
 rusmevichientong2010linearly,
 chu2011contextual,
 abbasi2011improved}
\end_layout

\end_inset

.
 In contrast,
 
\family typewriter
LinTS
\family default
,
 incorporating randomization by sampling from an estimated or posterior distribution of rewards,
 has attracted significant attention 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{agrawal2013thompson,
 abeille2017linear}
\end_layout

\end_inset

.
 Empirical studies,
 such as 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{chapelle2011}
\end_layout

\end_inset

,
 demonstrate that 
\family typewriter
LinTS
\family default
 frequently outperforms 
\family typewriter
LinUCB
\family default
 in practical scenarios,
 including online advertising and recommendation systems.
\end_layout

\begin_layout Standard
Theoretically,
 given contexts of dimension 
\begin_inset Formula $d$
\end_inset

 and time horizon 
\begin_inset Formula $T$
\end_inset

,
 
\family typewriter
LinUCB
\family default
 achieves a regret bound of 
\begin_inset Formula $\tilde{O}(d\sqrt{T})$
\end_inset

,
 matching the minimax lower bound of 
\begin_inset Formula $\Omega(d\sqrt{T})$
\end_inset

 up to logarithmic factors 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{lattimore2020bandit}
\end_layout

\end_inset

.
 In contrast,
 
\family typewriter
LinTS
\family default
 currently achieves a higher regret bound of 
\begin_inset Formula $\tilde{O}(d^{3/2}\sqrt{T})$
\end_inset

,
 and improving this bound remains an open problem.
\end_layout

\begin_layout Standard
Table
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ts-regret-comparison"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 summarizes existing regret bounds and associated assumptions for various 
\family typewriter
LinTS
\family default
 methods.
 Recent studies have contributed to narrowing this gap.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2021doubly}
\end_layout

\end_inset

 introduced a doubly robust (DR) estimator instead of the ridge estimator,
 achieving a regret bound of 
\begin_inset Formula $\tilde{O}(\alpha^{-1}\sqrt{T})$
\end_inset

 under independent contexts with strictly positive minimum eigenvalue 
\begin_inset Formula $\alpha>0$
\end_inset

.
 Special cases with 
\begin_inset Formula $\alpha^{-1}=O(d)$
\end_inset

 are further analyzed by 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{bastani2021mostly}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2023double}
\end_layout

\end_inset

.
 However,
 if 
\begin_inset Formula $\alpha$
\end_inset

 is extremely small (e.g.,
 fixed or highly correlated contexts),
 this bound can be worse than previous guarantees.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{huix2023tight}
\end_layout

\end_inset

 achieved the minimax rate of 
\begin_inset Formula $\tilde{O}(d\sqrt{T})$
\end_inset

,
 but under the assumption of a Gaussian prior distribution on the parameter,
 yielding Bayesian rather than worst-case frequentist guarantees.
 For the multi-armed bandit (MAB) setting,
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{agrawal2017near}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{zhu2020thompson}
\end_layout

\end_inset

 obtained minimax-optimal bounds,
 but analogous results for LinCB with arbitrary contexts remain unresolved.
\end_layout

\begin_layout Standard
Statistical techniques,
 particularly those addressing missing data,
 have significantly advanced LinCB research.
 Methods such as inverse probability weighting (IPW) and doubly robust estimation (DR) 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{bang2005doubly}
\end_layout

\end_inset

 tackle the selective reward observation problem by treating unselected rewards as missing data.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{dimakopoulou2019balanced}
\end_layout

\end_inset

 employed IPW in 
\family typewriter
LinTS
\family default
,
 obtaining a regret bound of 
\begin_inset Formula $\tilde{O}(d^{3/2}\sqrt{T})$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2019doubly}
\end_layout

\end_inset

 adapted DR methods to sparse,
 high-dimensional linear bandits,
 leveraging information from unselected contexts.
 Subsequent works by 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2021doubly}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2023double}
\end_layout

\end_inset

 enhanced DR estimators under assumptions of stochastic contexts and generalized linear rewards,
 respectively.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2023squeeze}
\end_layout

\end_inset

 further generalized DR methods to scenarios involving zero-probability arm selections.
 Despite these advancements,
 their reliance on IID or diversity assumptions limits broader applicability,
 leaving open the challenge of improving regret bounds for arbitrary contexts.
 This paper addresses this challenge by developing a novel estimator and algorithm that achieve the minimax optimal regret bound of 
\begin_inset Formula $\tilde{O}(d\sqrt{T})$
\end_inset

 without restrictive assumptions on the context distributions.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

% 3.
 LinCB
\end_layout

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Linear Contextual Bandit Problem
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:LinCB"

\end_inset

 This section presents the notation used throughout the paper and the formal definition of the linear contextual bandit (LinCB) problem.
\end_layout

\begin_layout Subsection
Notations
\end_layout

\begin_layout Standard
For a natural number 
\begin_inset Formula $n\in\mathbb{N}$
\end_inset

,
 define 
\begin_inset Formula $[n]:={1,2,\ldots,n}$
\end_inset

.
 For a positive semidefinite matrix 
\begin_inset Formula $M\in\mathbb{R}^{d\times d}$
\end_inset

 and a vector 
\begin_inset Formula $x\in\mathbb{R}^{d}$
\end_inset

,
 let 
\begin_inset Formula $\|x\|_{M}:=\sqrt{x^{\top}Mx}$
\end_inset

.
 For two matrices 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

,
 write 
\begin_inset Formula $A\succ B$
\end_inset

 (respectively 
\begin_inset Formula $A\succeq B$
\end_inset

) if 
\begin_inset Formula $A-B$
\end_inset

 is positive definite (respectively positive semidefinite).
\end_layout

\begin_layout Subsection
Problem Formulation
\end_layout

\begin_layout Standard
In LinCB,
 the environment defines a sequence of distributions over 
\begin_inset Formula $d$
\end_inset

-dimensional context vectors for 
\begin_inset Formula $K$
\end_inset

 arms,
 constrained to the set.
 Deterministic contexts can also be represented by setting each as a Dirac measure.
 The time horizon 
\begin_inset Formula $T$
\end_inset

 is finite but not known to the learner.
 At each round 
\begin_inset Formula $t\in[T]$
\end_inset

,
 the environment draws context vectors 
\begin_inset Formula $(X_{1,t},\ldots,X_{K,t})$
\end_inset

 from 
\begin_inset Formula $\mathcal{P}t$
\end_inset

,
 where 
\begin_inset Formula $X{k,t}$
\end_inset

 denotes the context for arm 
\begin_inset Formula $k$
\end_inset

.
 Assume that 
\begin_inset Formula $x_{\max}$
\end_inset

 is known;
 if unknown,
 it can be replaced with 
\begin_inset Formula $X_{\max,t}:=\max_{s\in[t]}\max_{k\in[K]}\|X_{k,s}\|_{2}$
\end_inset

.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathcal{H}_{t}$
\end_inset

 be the sigma-algebra generated by the observations until before selecting an action at round 
\begin_inset Formula $t$
\end_inset

,
 i.e.,
 
\begin_inset Formula 
\[
\Hcal_{t}=\bigcup_{\tau=1}^{t-1}\big[\{X_{i,\tau}\}_{i=1}^{K}\cup\{\Action{\tau}\}\cup\{\Reward{\Action{\tau}}{\tau}\}\big]\cup\{X_{i,t}\}_{i=1}^{K}.
\]

\end_inset

Based on 
\begin_inset Formula $\Hcal_{t}$
\end_inset

,
 the learner selects an arm 
\begin_inset Formula $a_{t}\in[K]$
\end_inset

 and receives a reward 
\begin_inset Formula $\Reward{a_{t}}{t}$
\end_inset

.
 In linear contextual bandits (LinCB),
 rewards are linear in the context,
 given by:
 
\begin_inset Formula 
\[
\Reward{a_{t}}{t}=X_{a_{t},t}^{\top}\theta_{\star}+\Error{a_{t}}{t},
\]

\end_inset

where 
\begin_inset Formula $\theta_{\star}\in\RR^{d}$
\end_inset

 is the unknown parameter such that 
\begin_inset Formula $\|\theta_{\star}\|_{2}\leq\theta_{\max}$
\end_inset

 for some unknown 
\begin_inset Formula $\theta_{\max}>0$
\end_inset

,
 and 
\begin_inset Formula $\Error{a_{t}}{t}$
\end_inset

 is conditionally zero-mean and 
\begin_inset Formula $\sigma$
\end_inset

-sub-Gaussian noise:
 
\begin_inset Formula 
\[
\CE{\exp(\lambda\Error{a_{t}}{t})}{\Hcal_{t}}\leq\exp\left(\frac{\lambda^{2}\sigma^{2}}{2}\right)\quad\text{for all }\lambda\in\RR,
\]

\end_inset

for some 
\begin_inset Formula $\sigma\geq0$
\end_inset

.
\end_layout

\begin_layout Standard
To normalize the scale of regret,
 following standard convention (e.g.,
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citealp{abbasi2011improved}
\end_layout

\end_inset

),
 assume that 
\begin_inset Formula $|X_{k,t}^{\top}\theta_{\star}|\leq1$
\end_inset

 for all 
\begin_inset Formula $k\in[K]$
\end_inset

 and 
\begin_inset Formula $t\in[T]$
\end_inset

.
 At each round 
\begin_inset Formula $t$
\end_inset

,
 the optimal arm 
\begin_inset Formula $a_{t}^{\star}$
\end_inset

 is defined as 
\begin_inset Formula $a_{t}^{\star}:=\arg\max_{k\in[K]}(X_{k,t}^{\top}\theta_{\star})$
\end_inset

,
 and the instantaneous regret is:
 
\begin_inset Formula 
\[
\Regret{t}:=X_{a_{t}^{\star},t}^{\top}\theta_{\star}-X_{a_{t},t}^{\top}\theta_{\star}.
\]

\end_inset

The goal is to minimize the cumulative regret over 
\begin_inset Formula $T$
\end_inset

 rounds:
 
\begin_inset Formula 
\[
R(T):=\sum_{t=1}^{T}\Regret{t}.
\]

\end_inset

This general formulation aligns with the standard LinCB setting (see,
 e.g.,
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citealp{abbasi2011improved}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citealp{lattimore2020bandit}
\end_layout

\end_inset

) and encompasses specific cases studied in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2021doubly}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2023squeeze}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

% 4.
 Proposed Method
\end_layout

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Proposed Method
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:proposed_method"

\end_inset


\end_layout

\begin_layout Standard
This section introduces the proposed estimation scheme that enables 
\family typewriter
LinTS
\family default
 to achieve a nearly minimax-optimal regret bound.
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:augment"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 motivates the use of hypothetical sample augmentation for parameter estimation.
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:hypo_contexts"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 presents a construction of hypothetical contexts that efficiently support parameter learning while minimizing the number of augmented samples.
 Building on the constructed contexts,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:hypothetical_bandit"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 defines an adaptive hypothetical bandit problem tailored for estimation.
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:coupling"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 describes a resampling strategy that couples the hypothetical and original bandit problems.
 Finally,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:algorithm"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 outlines the proposed algorithm,
 which incorporates the novel estimator derived from this framework.
\end_layout

\begin_layout Subsection
Augmenting Hypothetical Contexts for Linear Bandits
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:augment"

\end_inset


\end_layout

\begin_layout Standard
In linear contextual bandits (LinCB),
 the ridge estimator with 
\begin_inset Formula $\ell_{2}$
\end_inset

-regularization is a widely used approach for estimating the unknown parameter.
 This regularization can be interpreted as augmenting the dataset with artificial observations.
 Let 
\begin_inset Formula $\mathbf{e}i\in\mathbb{R}^{d}$
\end_inset

 denote the 
\begin_inset Formula $i$
\end_inset

-th Euclidean basis vector.
 Then,
 the ridge estimator at round 
\begin_inset Formula $t$
\end_inset

 can be expressed as 
\begin_inset Formula 
\begin{equation}
\left(\sum_{s=1}^{t}X_{a_{s},s}X_{a_{s},s}^{\top}+\sum_{i=1}^{d}\mathbf{e}_{i}\mathbf{e}_{i}^{\top}\right)^{-1}\left(\sum_{s=1}^{t}Y_{a_{s},s}X_{a_{s},s}+\sum_{i=1}^{d}0\cdot\mathbf{e}_{i}\right),\label{eq:ridge}
\end{equation}

\end_inset

which is equivalent to augmenting the dataset with dummy context–reward pairs 
\begin_inset Formula $(\mathbf{e}_{i},0)$
\end_inset

 for 
\begin_inset Formula $i\in[d]$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{bishop1995training}
\end_layout

\end_inset

 showed that the inclusion of such artificial data can improve generalization,
 i.e.,
 performance on test data that are not used in training.
 However,
 augmenting with zero-valued rewards induces shrinkage toward the origin,
 resulting in an estimator that is not adaptive to the observed data.
\end_layout

\begin_layout Standard
This observation motivates the use of alternative augmented samples that enhance parameter learning more effectively.
 Several estimators in the literature can be interpreted through the lens of such augmentation.
 For example,
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{perturb20akveton}
\end_layout

\end_inset

 proposed a method that adds multiple random perturbations to each reward observation;
 this is equivalent to augmenting the dataset with multiple context–reward pairs.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2021doubly}
\end_layout

\end_inset

 introduced a doubly robust (DR) estimator:
 
\begin_inset Formula 
\begin{equation}
\left(\sum_{s=1}^{t}\sum_{k=1}^{K}X_{k,s}X_{k,s}^{\top}+\sum_{i=1}^{d}\sqrt{\lambda_{t}}\mathbf{e}_{i}\left(\sqrt{\lambda_{t}}\mathbf{e}_{i}\right)^{\top}\right)^{-1}\left(\sum_{s=1}^{t}\sum_{k=1}^{K}X_{k,s}Y_{k,s}^{\mathrm{DR}}\right),\label{eq:DR_estimator}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda_{t}=\Omega(\sqrt{t})$
\end_inset

 is a regularization parameter and 
\begin_inset Formula $Y_{k,s}^{\mathrm{DR}}$
\end_inset

 denotes a DR pseudo-reward.
 This estimator can be interpreted as augmenting the unselected contexts with their corresponding unbiased pseudo-rewards 
\begin_inset Formula $(X_{k,s},Y_{k,s}^{\mathrm{DR}})$
\end_inset

 for all 
\begin_inset Formula $k\in[K]$
\end_inset

 and 
\begin_inset Formula $s\in[t]$
\end_inset

.
\end_layout

\begin_layout Standard
These augmented observations construct the Gram matrix that controls the self-normalized error of the estimator and influences its generalization performance.
 In the ridge estimator 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ridge"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 the Gram matrix includes only the contexts corresponding to selected arms,
 and thus the estimator converges within the span of those vectors.
 In contrast,
 the DR estimator 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DR_estimator"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 incorporates all contexts,
 yielding a more well-conditioned matrix and enabling convergence in all directions spanned by the 
\begin_inset Formula $K$
\end_inset

 context vectors.
\end_layout

\begin_layout Standard
The well-conditioned Gram matrix plays a critical role in determining the convergence rate of the estimator in both linear regression and bandit settings.
 In the experimental design literature (e.g.,
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citealp{smith1918standard}
\end_layout

\end_inset

;
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citealp{guttorp2009karl}
\end_layout

\end_inset

) and linear bandits (e.g.,
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citealp{soare2014best}
\end_layout

\end_inset

;
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citealp{tao2018best}
\end_layout

\end_inset

),
 techniques such as E-optimal design aim to maximize the minimum eigenvalue of the Gram matrix to enhance estimation quality.
 Consequently,
 designing augmentations that yield well-conditioned Gram matrices is essential for accurate parameter estimation and low regret.
\end_layout

\begin_layout Standard
Although the Gram matrix of the DR estimator includes all 
\begin_inset Formula $K$
\end_inset

 arms,
 the augmentation involves 
\begin_inset Formula $K$
\end_inset

 augmented samples in each round,
 which introduces additional variance that scales linearly with 
\begin_inset Formula $K$
\end_inset

.
 To address this,
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2021doubly}
\end_layout

\end_inset

 assumed that the context covariance matrix has a strictly positive minimum eigenvalue,
 ensuring rapid increase in the minimum eigenvalue of the covariance.
\end_layout

\begin_layout Standard
Rather than augmenting with the full set 
\begin_inset Formula $\{(X_{k,s},Y_{k,s}^{\mathrm{DR}}):k\in[K],s\in[t]\}$
\end_inset

,
 the proposed method constructs a hypothetical dataset with reduced number of augmented samples by identifying a set of orthogonal eigenvectors that are informative for learning all 
\begin_inset Formula $K$
\end_inset

 rewards in each round.
 Moreover,
 instead of using dummy vectors such as 
\begin_inset Formula $(\mathbf{e}_{i},0)$
\end_inset

,
 the proposed estimator augments basis vectors orthogonal to the span of the observed contexts,
 thereby adaptively improving generalization to future inputs.
\end_layout

\begin_layout Subsection
Design of Hypothetical Contexts
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:hypo_contexts"

\end_inset


\end_layout

\begin_layout Standard
For each round 
\begin_inset Formula $t$
\end_inset

,
 let 
\begin_inset Formula $a_{t}\sim\pi_{t}$
\end_inset

 denote the arm drawn according to the policy 
\begin_inset Formula $\pi_{t}$
\end_inset

.
 Before selecting 
\begin_inset Formula $a_{t}$
\end_inset

,
 a set of hypothetical contexts is constructed to dominate the covariance structure of the original context vectors.
 Let 
\begin_inset Formula $\Xb_{t}=[X_{1,t},\cdots,X_{K,t}]\in\RR^{d\times K}$
\end_inset

 denote a concatenated context matrix and 
\begin_inset Formula $r_{t}$
\end_inset

 denote its rank.
 Note that 
\begin_inset Formula $r_{t}\le\min\{d,K\}$
\end_inset

.
 By applying the singular value decomposition,
 there exists unitary matrices 
\begin_inset Formula $\Ub_{t}\in\RR^{d\times d},\Vb_{t}\in\RR^{K\times K}$
\end_inset

,
 and a rectangular diagonal matrix 
\begin_inset Formula $\Lambda_{t}\in\RR^{d\times K}$
\end_inset

 such that 
\begin_inset Formula $\Xb_{t}=U_{t}\Lambda_{t}\Gb_{t}$
\end_inset

.
 For each 
\begin_inset Formula $k\in[K]$
\end_inset

 let 
\begin_inset Formula $\eb_{k}\in\RR^{K}$
\end_inset

 denote the Euclidean basis in 
\begin_inset Formula $\RR^{K}$
\end_inset

.
 Then,
 writing 
\begin_inset Formula $\Ub_{t}=[u_{1,t},\ldots,u_{d,t}]$
\end_inset

 for 
\begin_inset Formula $u_{i,t}\in\RR^{d}$
\end_inset

,
 
\begin_inset Formula 
\begin{equation}
X_{k,t}=\sum_{i=1}^{r_{t}}\Vb_{t}(k,i)\lambda_{i,t}u_{i,t},\label{eq:X_decomp}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Vb_{t}(k,i)$
\end_inset

 is the entry on
\begin_inset Formula $k$
\end_inset

-th row and 
\begin_inset Formula $i$
\end_inset

-th column of 
\begin_inset Formula $\Gb_{t}$
\end_inset

.
 Because 
\begin_inset Formula $\|X_{k}\|_{2}\le x_{\max}$
\end_inset

 and 
\begin_inset Formula $u_{1,t},\ldots,u_{r_{t},t}$
\end_inset

 are orthonormal,
 
\begin_inset Formula 
\begin{equation}
\|X_{k,t}\|_{2}^{2}=\sum_{i=1}^{r_{t}}\Vb_{t}(k,i)^{2}\lambda_{i,t}^{2}\le x_{\max}^{2}\label{eq:norm_bound}
\end{equation}

\end_inset

Let 
\begin_inset Formula $\Pb_{a_{t},t}:=X_{a_{t},t}X_{a_{t},t}^{\top}/\|X_{a_{t},t}\|_{2}^{2}$
\end_inset

 denote a projection matrix onto 
\begin_inset Formula $X_{a_{t},t}$
\end_inset

.
 For brevity,
 let us write 
\begin_inset Formula $\bar{x}_{\max}:=\max\{x_{\max},1\}$
\end_inset

.
 Define the hypothetical contexts for the round 
\begin_inset Formula $t$
\end_inset

 by,
 
\begin_inset Formula 
\[
H_{i,t}:=\begin{cases}
\bar{x}_{\max}(\Ib_{d}-\Pb_{a_{t},t})u_{i,t}, & \text{for }i=1,\dots,r_{t},\\
\sqrt{\bar{x}_{\max}^{2}-\|X_{a_{t},t}\|_{2}^{2}}\frac{X_{a_{t},t}}{\|X_{a_{t},t}\|_{2}} & \text{for }i=r_{t}+1\\
X_{a_{t},t}, & \text{for }i=r_{t}+2.
\end{cases}
\]

\end_inset

The hypothectical contexts consist of three components:
 (i) bases that are projected onto the orthogonal space of the selected contexts (ii) enlongated selected contexts,
 and (iii) the selected contexts.
 This construction ensures the following property.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{lemma}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

Hypothetical Gram Matrix Domination Lemma
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "lem:Hypo_dom"

\end_inset

 For each 
\begin_inset Formula $t$
\end_inset

,
 
\begin_inset Formula 
\[
2\sum_{i=1}^{r_{t}+2}H_{i,t}H_{i,t}^{\top}\succeq X_{k,t}X_{k,t}^{\top}
\]

\end_inset

for any 
\begin_inset Formula $k\in[K]$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{lemma}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
For each 
\begin_inset Formula $k\in[K]$
\end_inset

,
 by 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:X_decomp"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 
\begin_inset Formula 
\[
(\Ib_{d}-\Pb_{a_{t},t})X_{k,t}=\sum_{i=1}^{r_{t}}\Vb_{t}(k,i)\lambda_{i,t}(\Ib_{d}-\Pb_{a_{t},t})u_{i,t}.
\]

\end_inset

For any vector 
\begin_inset Formula $\xi\in\RR^{d}$
\end_inset

,
 by Cauchy-Schwartz inequality,
\begin_inset Formula 
\begin{align*}
\big(\xi^{\top}(\Ib_{d}-\Pb_{a_{t},t})X_{k,t}\big)^{2}= & \big(\sum_{i=1}^{r_{t}}\Vb_{t}(k,i)\lambda_{i,t}\xi^{\top}(\Ib_{d}-\Pb_{a_{t},t})u_{i,t}\big)^{2}\\
\le & \big(\sum_{i=1}^{r_{t}}\Vb_{t}(k,i)^{2}\lambda_{i,t}^{2}\big)\big(\sum_{i=1}^{r_{t}}\big(\xi^{\top}(\Ib_{d}-\Pb_{a_{t},t})u_{i,t}\big)^{2}
\end{align*}

\end_inset

By definition of 
\begin_inset Formula $H_{i,t}$
\end_inset

,
 
\begin_inset Formula 
\begin{equation}
\big(\xi^{\top}(\Ib_{d}-\Pb_{a_{t},t})X_{k,t}\big)^{2}\le\frac{\big(\sum_{i=1}^{r_{t}}\Vb_{t}(k,i)^{2}\lambda_{i,t}^{2}\big)}{\bar{x}_{\max}^{2}}\big(\sum_{i=1}^{r_{t}}\xi^{\top}H_{i,t}\big)^{2}\le\big(\sum_{i=1}^{r_{t}}\xi^{\top}H_{i,t}\big)^{2},\label{eq:Gram_1}
\end{equation}

\end_inset

where the last inequality holds by 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:norm_bound"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 For 
\begin_inset Formula $a,b\in\RR$
\end_inset

,
 
\begin_inset Formula $(a-b)^{2}\ge a^{2}/2-b^{2}$
\end_inset

 and thus,
\begin_inset Formula 
\[
\big(\xi^{\top}(\Ib_{d}-\Pb_{a_{t},t})X_{k,t}\big)^{2}\ge\frac{(\xi^{\top}X_{k,t})^{2}}{2}-(\xi^{\top}\Pb_{a_{t},t}X_{k,t})^{2}.
\]

\end_inset

By Cauchy-Schwartz inequality,
 
\begin_inset Formula 
\[
(\xi^{\top}\Pb_{a_{t},t}X_{k,t})^{2}\le(\xi^{\top}X_{a_{t},t})^{2}\frac{\|X_{k,t}\|_{2}^{2}}{\|X_{a_{t},t}\|_{2}^{2}}\le(\xi^{\top}X_{a_{t},t})^{2}\frac{\bar{x}_{\max}^{2}}{\|X_{a_{t},t}\|_{2}^{2}}.
\]

\end_inset

By definition of 
\begin_inset Formula $H_{r_{t}+1}$
\end_inset

,
 it follows that 
\begin_inset Formula $(\xi^{\top}\Pb_{a_{t},t}X_{k,t})^{2}\le(\xi^{\top}H_{r_{t}+1,t})^{2}$
\end_inset

 and
\begin_inset Formula 
\[
\big(\xi^{\top}(\Ib_{d}-\Pb_{a_{t},t})X_{k,t}\big)^{2}\ge\frac{(\xi^{\top}X_{k,t})^{2}}{2}-(\xi^{\top}H_{r_{t}+1,t})^{2}.
\]

\end_inset

Plugging in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Gram_1"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 and rearranging the terms
\begin_inset Formula 
\[
\frac{(\xi^{\top}X_{k,t})^{2}}{2}\le\big(\sum_{i=1}^{r_{t}+2}\xi^{\top}H_{i,t}\big)^{2},
\]

\end_inset

which completes the proof.
 
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
The novel Gram matrix is equivalent to the sum of basis vectors inflated by 
\begin_inset Formula $\bar{x}_{\max}^{2}$
\end_inset

.
 While 
\begin_inset CommandInset citation
LatexCommand cite
key "kim2021doubly"
literal "false"

\end_inset

 augmented 
\begin_inset Formula $K$
\end_inset

 arms which may be too excessive and cause additional error,
 the proposed method augments 
\begin_inset Formula $r_{t}+1$
\end_inset

 vectors;
 
\begin_inset Formula $r_{t}$
\end_inset

 vectors are orthogonal to the selected contexts and the other vectors are align 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{lemma}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

Hypothetical Gram Matrix Equivalence Lemma
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "lem:Hypo_equiv"

\end_inset

 For each 
\begin_inset Formula $t$
\end_inset

,
 
\begin_inset Formula 
\[
\frac{\bar{x}_{\max}^{2}}{2}\sum_{i=1}^{r_{t}}u_{i,t}u_{i,t}^{\top}\preceq\sum_{i=1}^{r_{t}+2}H_{i,t}H_{i,t}^{\top}\preceq5\bar{x}_{\max}^{2}\sum_{i=1}^{r_{t}}u_{i,t}u_{i,t}^{\top}.
\]

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{lemma}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
For any vector 
\begin_inset Formula $\xi\in\RR^{d}$
\end_inset

,
 by definition of 
\begin_inset Formula $H_{i,t}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\sum_{i=1}^{r_{t}+2}(\xi^{\top}H_{i,t})^{2}=\bar{x}_{\max}^{2}\sum_{i=1}^{r_{t}}\big(\xi^{\top}(\Ib_{d}-\Pb_{a_{t},t})u_{i,t}\big)^{2}+\frac{\bar{x}_{\max}^{2}}{\|X_{a_{t},t}\|_{2}^{2}}(\xi^{\top}X_{a_{t},t})^{2}.\label{eq:Gram_equiv_0}
\end{equation}

\end_inset

To prove the lower Lowner order,
 since 
\begin_inset Formula $(a-b)^{2}\ge a^{2}/2-b^{2}$
\end_inset

,
\begin_inset Formula 
\[
\sum_{i=1}^{r_{t}}\big(\xi^{\top}(\Ib_{d}-\Pb_{a_{t},t})u_{i,t}\big)^{2}\ge\frac{1}{2}\sum_{i=1}^{r_{t}}(\xi^{\top}u_{i,t})^{2}-\sum_{i=1}^{r_{t}}(\xi^{\top}\Pb_{a_{t},t}u_{i,t})^{2}.
\]

\end_inset

By definition of 
\begin_inset Formula $\Pb_{a_{t},t}$
\end_inset

 and 
\begin_inset Formula $u_{1,t},\ldots,u_{r_{t},t}$
\end_inset

 are orthonormal,
 
\begin_inset Formula 
\begin{equation}
\sum_{i=1}^{r_{t}}(\xi^{\top}\Pb_{a_{t},t}u_{i,t})^{2}\le\frac{\xi^{\top}X_{a_{t},t}X_{a_{t},t}^{\top}\big(\sum_{i=1}^{r_{t}}u_{i,t}u_{i,t}^{\top}\big)X_{a_{t},t}X_{a_{t},t}^{\top}\xi}{\|X_{a_{t},t}\|_{2}^{4}}\le\frac{(\xi^{\top}X_{a_{t},t})^{2}}{\|X_{a_{t},t}\|_{2}^{2}}.\label{eq:Gram_equiv_a_t_norm}
\end{equation}

\end_inset

Thus,
\begin_inset Formula 
\[
\sum_{i=1}^{r_{t}}\big(\xi^{\top}(\Ib_{d}-\Pb_{a_{t},t})u_{i,t}\big)^{2}\ge\frac{1}{2}\sum_{i=1}^{r_{t}}(\xi^{\top}u_{i,t})^{2}-\frac{(\xi^{\top}X_{a_{t},t})^{2}}{\|X_{a_{t},t}\|_{2}^{2}}.
\]

\end_inset

Plugging in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Gram_equiv_0"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
\begin_inset Formula 
\[
\sum_{i=1}^{r_{t}+2}(\xi^{\top}H_{i,t})^{2}\ge\frac{\bar{x}_{\max}^{2}}{2}\sum_{i=1}^{r_{t}}(\xi^{\top}u_{i,t})^{2},
\]

\end_inset

which completes the lower Lowner order.
\end_layout

\begin_layout Proof
To prove the upper Lowner order,
 since 
\begin_inset Formula $(a-b)^{2}\le2a^{2}+2b^{2}$
\end_inset

 
\begin_inset Formula 
\[
\bar{x}_{\max}^{2}\sum_{i=1}^{r_{t}}\big(\xi^{\top}(\Ib_{d}-\Pb_{a_{t},t})u_{i,t}\big)^{2}\le2\bar{x}_{\max}^{2}\sum_{i=1}^{r_{t}}\big((\xi^{\top}u_{i,t})^{2}+(\xi^{\top}\Pb_{a_{t},t}u_{i,t})^{2}\big).
\]

\end_inset

By 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Gram_equiv_a_t_norm"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
\begin_inset Formula 
\[
\bar{x}_{\max}^{2}\sum_{i=1}^{r_{t}}\big(\xi^{\top}(\Ib_{d}-\Pb_{a_{t},t})u_{i,t}\big)^{2}\le2\bar{x}_{\max}^{2}\sum_{i=1}^{r_{t}}(\xi^{\top}u_{i,t})^{2}+\frac{2\bar{x}_{\max}^{2}}{\|X_{a_{t},t}\|_{2}^{2}}(X_{a_{t},t}^{\top}\xi)^{2}.
\]

\end_inset

Plugging in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Gram_equiv_0"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
\begin_inset Formula 
\begin{equation}
\sum_{i=1}^{r_{t}+2}(\xi^{\top}H_{i,t})^{2}\le2\bar{x}_{\max}^{2}\sum_{i=1}^{r_{t}}(\xi^{\top}u_{i,t})^{2}+\frac{3\bar{x}_{\max}^{2}}{\|X_{a_{t},t}\|_{2}^{2}}(\xi^{\top}X_{a_{t},t})^{2}.\label{eq:Gram_equiv_1}
\end{equation}

\end_inset

From the equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:X_decomp"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
\begin_inset Formula 
\[
(\xi^{\top}X_{a_{t},t})^{2}=\big(\sum_{i=1}^{r_{t}}\Vb_{t}(a_{t},i)\lambda_{i,t}(\xi^{\top}u_{i,t})\big)^{2}\le\big(\sum_{i=1}^{r_{t}}\Vb_{t}(a_{t},i)^{2}\lambda_{i,t}^{2}\big)\big(\sum_{i=1}^{r_{t}}(\xi^{\top}u_{i,t})^{2}\big),
\]

\end_inset

where the last inequality uses Cauchy-Schwartz inequality.
 Because 
\begin_inset Formula $\|X_{a_{t},t}\|_{2}^{2}=\sum_{i=1}^{r_{t}}\Vb_{t}(a_{t},i)^{2}\lambda_{i,t}^{2}$
\end_inset

,
\begin_inset Formula 
\[
(\xi^{\top}X_{a_{t},t})^{2}\le\|X_{a_{t},t}\|_{2}^{2}\sum_{i=1}^{r_{t}}(\xi^{\top}u_{i,t})^{2}.
\]

\end_inset

Plugging in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Gram_equiv_1"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
\begin_inset Formula 
\[
\sum_{i=1}^{r_{t}+2}(\xi^{\top}H_{i,t})^{2}\le5\bar{x}_{\max}^{2}\sum_{i=1}^{r_{t}}(\xi^{\top}u_{i,t})^{2},
\]

\end_inset

which completes the upper Lowener order.
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
Lemma ??
 ensures that the compressed set 
\begin_inset Formula $\{Z_{i,t}\}_{i=1}^{r_{t}+1}$
\end_inset

 dominates the outer product of any contexts,
 while reducing the number of arms to 
\begin_inset Formula $r_{t}+1$
\end_inset

.
\end_layout

\begin_layout Subsection
Orthogonal Basis Augmentation
\end_layout

\begin_layout Standard
To replace the artificial augmentation 
\begin_inset Formula $\{(\mathbf{e}_{i},0):i\in[d]\}$
\end_inset

 in the ridge estimator
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ridge"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 an orthogonal basis is constructed at selected rounds.
 Given hyperparameters 
\begin_inset Formula $\delta\in(0,1)$
\end_inset

 and 
\begin_inset Formula $\gamma\in(0,1)$
\end_inset

,
 define:
 
\begin_inset Formula 
\begin{equation}
h_{t}:=\left\lceil \frac{2}{\frac{1}{2}-e^{-1}}\frac{d}{1-\gamma}\log\frac{d(t+1)^{2}}{\delta}\right\rceil ,\label{eq:h_t}
\end{equation}

\end_inset

which specifies the number of rounds allocated for orthogonal basis augmentation.
 The subset of rounds for the augmentation 
\begin_inset Formula $\mathcal{A}_{t}\subseteq[t]$
\end_inset

 is defined recursively as:
 
\begin_inset Formula 
\begin{equation}
\mathcal{A}_{0}=\emptyset,\quad\mathcal{A}_{t}=\begin{cases}
\mathcal{A}_{t-1}\cup\{t\}, & \text{if }|\mathcal{A}_{t-1}|<h_{t},\\
\mathcal{A}_{t-1}, & \text{otherwise}.
\end{cases}\label{eq:A}
\end{equation}

\end_inset

Also define:
 
\begin_inset Formula 
\begin{equation}
T_{1}:=\inf\{t\ge1:t\ge h_{t}\}.\label{eq:T_1}
\end{equation}

\end_inset

By Proposition
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "prop:logt"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 the number of rounds 
\begin_inset Formula $T_{1}$
\end_inset

 is bounded by 
\begin_inset Formula 
\[
T_{1}\le\frac{8}{\frac{1}{2}-e^{-1}}\frac{d}{1-\gamma}\left(1+\log\frac{4}{e/2-1}\frac{d}{1-\gamma}\sqrt{\frac{d}{\delta}}\right).
\]

\end_inset

Thus,
 for all 
\begin_inset Formula $t\ge T_{1}$
\end_inset

,
 it holds that 
\begin_inset Formula $h_{t}\le|\mathcal{A}_{t}|\le h_{t}+1$
\end_inset


\end_layout

\begin_layout Standard
Now we introduce the orthogonal augmentation at round 
\begin_inset Formula $s\in\Acal_{t}$
\end_inset

.
 If 
\begin_inset Formula $r_{s}<d$
\end_inset

,
 the Gram–Schmidt process is applied to 
\begin_inset Formula $\{u_{i,s}:i\in[r_{s}]\}$
\end_inset

 to construct an orthonormal set 
\begin_inset Formula $\{u_{i,s}\}_{i=r_{s}+1}^{d}$
\end_inset

.
 Recall that 
\begin_inset Formula $\bar{x}_{\max}=\max\{x_{\max},1\}$
\end_inset

 and we define the hypothetical contexts for the orthogonal augmentation round by,
\begin_inset Formula 
\[
\tilde{H}_{i,s}:=\begin{cases}
\bar{x}_{\max}u_{i,s}, & \text{for }i=1,\dots,d,\\
X_{a_{s},s} & \text{for }i=d+1
\end{cases}
\]

\end_inset

The equivalent of the sum of hypothetical contexts are as follows:
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{lemma}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

Gram matrix with hypothetical contexts
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "lem:tilde_equivlence"

\end_inset

 For any 
\begin_inset Formula $t\ge T_{1}$
\end_inset

 and any combinations of all actions 
\begin_inset Formula $(k_{1},\ldots,k_{t})\in[K]^{t}$
\end_inset

,
 the Gram matrix 
\begin_inset Formula $\Gb_{t}$
\end_inset

 satisfies 
\begin_inset Formula 
\[
\bar{x}_{\max}\Ib_{d}\preceq\sum_{i=1}^{d+1}\tilde{H}_{i,s}\tilde{H}_{i,s}^{\top}\preceq2\bar{x}_{\max}\Ib_{d}.
\]

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{lemma}
\end_layout

\end_inset

 For the augmentation round 
\begin_inset Formula $\Acal_{t}$
\end_inset

,
 the proposed method focuses on the construction of the orthogonal basis that may be required for the future rounds.
 
\end_layout

\begin_layout Standard
Now,
 define the number of arms in the hypothetical bandit problem at round 
\begin_inset Formula $s$
\end_inset

 as:
 
\begin_inset Formula 
\begin{equation}
N_{s}:=\begin{cases}
r_{s}+2 & \text{if }s\in[t]\setminus\mathcal{A}_{t},\\
d+1 & \text{if }s\in\mathcal{A}_{t}.
\end{cases}\label{eq:N}
\end{equation}

\end_inset

The number of the hypothetical problem solely depends on whether the round 
\begin_inset Formula $s$
\end_inset

 is included in 
\begin_inset Formula $\Acal_{t}$
\end_inset

 or not.
 For all 
\begin_inset Formula $s\in[t]$
\end_inset

 and 
\begin_inset Formula $i\in[N_{s}]$
\end_inset

,
 the 
\series bold
hypothetical contexts
\series default
 are constructed as 
\begin_inset Formula 
\begin{equation}
Z_{i,s}:=\begin{cases}
H_{i,s}, & s\in[t]\setminus\mathcal{A}_{t},\\
\tilde{H}_{i,s}, & s\in\mathcal{A}_{t}
\end{cases}.\label{eq:new_contexts}
\end{equation}

\end_inset

At round 
\begin_inset Formula $t$
\end_inset

,
 the Gram matrix of all hypothetical contexts is given by:
 
\begin_inset Formula 
\[
\Gb_{t}:=\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}Z_{i,s}Z_{i,s}^{\top}=\sum_{s\in[t]\setminus\mathcal{A}_{t}}\sum_{i=1}^{r_{s}+2}H_{i,s}H_{i,s}^{\top}+\sum_{s\in\mathcal{A}_{t}}\sum_{i=1}^{d+1}\tilde{H}_{i,s}\tilde{H}_{i,s}^{\top},
\]

\end_inset

and satisfies the following bounds.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{lemma}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

Gram matrix with hypothetical contexts
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "lem:Gram"

\end_inset

 For any 
\begin_inset Formula $t\ge T_{1}$
\end_inset

 and any combinations of all actions 
\begin_inset Formula $(k_{1},\ldots,k_{t})\in[K]^{t}$
\end_inset

,
 the Gram matrix 
\begin_inset Formula $\Gb_{t}$
\end_inset

 satisfies 
\begin_inset Formula 
\[
\Gb_{t}\succeq\sum_{s\in[t]\setminus\mathcal{A}_{t}}X_{k_{s},s}X_{k_{s},s}^{\top}+\max\{x_{\max}^{2},1\}h_{t}I_{d}.
\]

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{lemma}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
For 
\begin_inset Formula $s\in\Acal_{t}$
\end_inset

,
 by definition of 
\begin_inset Formula $\tilde{H}_{i,s}$
\end_inset

,
 
\begin_inset Formula 
\[
\sum_{i=1}^{d+1}\tilde{H}_{i,s}\tilde{H}_{i,s}^{\top}\succeq\max\{x_{\max}^{2},1\}\sum_{i=1}^{d}u_{i,s}u_{i,s}^{\top}.
\]

\end_inset

Because 
\begin_inset Formula $\{u_{i,s}:i\in[d]\}$
\end_inset

 are 
\begin_inset Formula $d$
\end_inset

 orthonormal vectors in 
\begin_inset Formula $\RR^{d}$
\end_inset

,
 we obtain 
\begin_inset Formula $\sum_{i=1}^{d}u_{i,s}u_{i,s}^{\top}=I_{d}$
\end_inset

.
 Since 
\begin_inset Formula $t\ge T_{1}$
\end_inset

 and 
\begin_inset Formula $|\Acal_{t}|\ge h_{t}$
\end_inset

,
 
\begin_inset Formula 
\[
\sum_{s\in\mathcal{A}_{t}}\sum_{i=1}^{d+1}\tilde{H}_{i,s}\tilde{H}_{i,s}^{\top}\succeq h_{t}\max\{x_{\max}^{2},1\}I_{d}.
\]

\end_inset

For 
\begin_inset Formula $s\in[t]\setminus\Acal_{t}$
\end_inset

 and 
\begin_inset Formula $k_{s}\in[K]$
\end_inset

,
 from
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Gram_equiv"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 
\begin_inset Formula 
\[
\sum_{i=1}^{r_{s}+1}H_{i,s}H_{i,s}^{\top}\succeq X_{k_{s},s}X_{k_{s},s}^{\top}.
\]

\end_inset

Thus,
 
\begin_inset Formula 
\[
\Gb_{t}=\sum_{s\in[t]\setminus\mathcal{A}_{t}}X_{k_{s},s}X_{k_{s},s}^{\top}+h_{t}\max\{x_{\max}^{2},1\}I_{d},
\]

\end_inset

which completes the proof.
 
\end_layout

\begin_layout Standard
Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:Gram"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 ensures that the hypothetical contexts preserve the Gram matrix of all 
\begin_inset Formula $K$
\end_inset

 context vectors while reducing the number of augmented samples to 
\begin_inset Formula $N_{s}$
\end_inset

 in each round.
 The proposed method retains statistical efficiency comparable to full augmentation 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{kim2021doubly}
\end_layout

\end_inset

,
 with less number of augmented context samples.
\end_layout

\begin_layout Subsection
A Hypothetical Linear Contextual Bandit
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:hypothetical_bandit"

\end_inset


\end_layout

\begin_layout Standard
Based on the sample 
\begin_inset Formula $a_{t}\sim\pi_{t}$
\end_inset

,
 construct the hypothetical contexts 
\begin_inset Formula $Z_{i,s}$
\end_inset

 as previously described.
 For each 
\begin_inset Formula $s\in[t]$
\end_inset

 and 
\begin_inset Formula $i\in[N_{s}]$
\end_inset

,
 define the corresponding hypothetical rewards:
 
\begin_inset Formula 
\[
W_{i,s}:=Z_{i,s}^{\top}\theta_{\star}+\eta_{a_{s},s},
\]

\end_inset

where 
\begin_inset Formula $\eta_{a_{s},s}$
\end_inset

 is shared with the original bandit problem.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\tilde{a}_{s}\in[N_{s}]$
\end_inset

 be a hypothetical action sampled from the distribution:
 
\begin_inset Formula 
\begin{equation}
\mathbb{P}(\tilde{a}_{s}=i):=\phi_{i,s}=\begin{cases}
\frac{1-\gamma}{N_{s}-1}, & \text{if }i\in[N_{s}-1],\\
\gamma, & \text{if }i=N_{s},
\end{cases}\label{eq:pseudo_prob}
\end{equation}

\end_inset

where 
\begin_inset Formula $\gamma\in(0,1)$
\end_inset

 determines the probability mass assigned to the original context 
\begin_inset Formula $X_{a_{s},s}$
\end_inset

.
 As 
\begin_inset Formula $\gamma$
\end_inset

 increases,
 the sampling concentrates on arm 
\begin_inset Formula $N_{s}$
\end_inset

,
 increasing the variance of inverse-probability weights for the other arms.
 To mitigate this,
 the number of rounds with orthogonal basis augmentation,
 
\begin_inset Formula $|\mathcal{A}_{t}|\ge h_{t}$
\end_inset

,
 must be sufficiently large.
 This construction defines a hypothetical linear bandit problem 
\begin_inset Formula $\{(Z_{i,s},W_{i,s}):i\in[N_{s}],s\in[t]\}$
\end_inset

 that shares the parameter 
\begin_inset Formula $\theta_{\star}$
\end_inset

 with the original problem.
\end_layout

\begin_layout Standard
To perform estimation,
 construct the following ridge estimator as a reference:
 
\begin_inset Formula 
\begin{equation}
\check{\theta}_{t}:=\left(\sum_{s=1}^{t}X_{a_{s},s}X_{a_{s},s}^{\top}+\gamma I_{d}\right)^{-1}\left(\sum_{s=1}^{t}X_{a_{s},s}Y_{a_{s},s}\right),\label{eq:impute}
\end{equation}

\end_inset

with regularization parameter 
\begin_inset Formula $\gamma\in(0,1)$
\end_inset

 as used in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:pseudo_prob"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 Using 
\begin_inset Formula $\check{\theta}_{t}$
\end_inset

,
 define the pseudo-rewards:
 
\begin_inset Formula 
\begin{equation}
\tilde{W}_{i,s}^{H(\check{\theta}_{t})}:=\left(1-\frac{\mathbb{I}(\tilde{a}_{s}=i)}{\phi_{i,s}}\right)Z_{i,s}^{\top}\check{\theta}_{t}+\frac{\mathbb{I}(\tilde{a}_{s}=i)}{\phi_{i,s}}W_{i,s}.\label{eq:HDRY}
\end{equation}

\end_inset

This pseudo-reward is unbiased:
 
\begin_inset Formula $\mathbb{E}[\tilde{W}_{i,s}^{H(\check{\theta}_{t})}]=Z_{i,s}^{\top}\theta_{\star}$
\end_inset

 for all 
\begin_inset Formula $i\in[N_{s}]$
\end_inset

.
 The estimator for 
\begin_inset Formula $\theta_{\star}$
\end_inset

 is then:
 
\begin_inset Formula 
\begin{equation}
\tilde{\theta}_{t}^{H(\check{\theta}_{t})}:=\left(\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}Z_{i,s}Z_{i,s}^{\top}\right)^{-1}\left(\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}\tilde{W}_{i,s}^{H(\check{\theta}_{t})}Z_{i,s}\right).\label{eq:Hypo_DR}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
However,
 this estimator cannot be computed directly,
 as the rewards 
\begin_inset Formula $W_{i,s}$
\end_inset

 for 
\begin_inset Formula $i\in[N_{s}-1]$
\end_inset

 are unobserved.
 Only 
\begin_inset Formula $W_{N_{s},s}=Y_{a_{s},s}$
\end_inset

 is available.
 Thus,
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:HDRY"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 is computable for all 
\begin_inset Formula $i\in[N_{s}]$
\end_inset

 only when 
\begin_inset Formula $W_{\tilde{a}_{s},s}=Y_{a_{s},s}$
\end_inset

,
 i.e.,
 when the sampled context in the hypothetical bandit matches the observed context from the original bandit.
 Since both models share the same parameter 
\begin_inset Formula $\theta_{\star}$
\end_inset

 and noise 
\begin_inset Formula $\eta_{a_{s},s}$
\end_inset

,
 this condition is equivalent to 
\begin_inset Formula $Z_{\tilde{a}_{s},s}=X_{a_{s},s}$
\end_inset

.
 This matching event provides the motivation for the coupling technique introduced in the next section.
\end_layout

\begin_layout Subsection
Coupling the Hypothetical and Original Linear Contextual Bandits
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:coupling"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{tikzpicture}[
\end_layout

\begin_layout Plain Layout

  >=Stealth,
\end_layout

\begin_layout Plain Layout

  node distance = 0.7cm and 0.9cm,
\end_layout

\begin_layout Plain Layout

  every node/.style = font=
\backslash
small,
\end_layout

\begin_layout Plain Layout

  process/.style = draw,
 rounded corners,
 minimum width=30mm,
 minimum height=11mm,
 align=center,
\end_layout

\begin_layout Plain Layout

  decision/.style = draw,
 diamond,
 aspect=2,
 inner sep=1pt,
 align=center
\end_layout

\begin_layout Plain Layout

]
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% Row 1 ---------------------------------------------------------
\end_layout

\begin_layout Plain Layout


\backslash
node[process] (theta)   {Estimate $
\backslash
widehat{
\backslash
theta}_{t-1}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[process,
 right=of theta]  (observe) {Observe $
\backslash
{
\backslash
,X_{k,t}:k
\backslash
in[K]
\backslash
}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[process,
 right=of observe]  (pi) {Compute the policy $
\backslash
pi_t$};
\end_layout

\begin_layout Plain Layout


\backslash
node[process,
 below=of pi] (sampleA) {Sample a candidate action 
\backslash

\backslash
 $a_t 
\backslash
sim 
\backslash
pi_t$};
\end_layout

\begin_layout Plain Layout


\backslash
node[process,
 below=of sampleA] (compZ)  {Compute hypothetical contexts 
\backslash

\backslash
 $
\backslash
{Z_{i,t}:
 i
\backslash
in[N_t]
\backslash
}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[process,
 below=of compZ]   (sampleC){Sample hypothetical action 
\backslash

\backslash
 $
\backslash
tilde{a}_t
\backslash
sim
\backslash
tilde{
\backslash
pi}_t$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% Decision ------------------------------------------------------
\end_layout

\begin_layout Plain Layout


\backslash
node[decision,
 left=of sampleC] (decide)
\end_layout

\begin_layout Plain Layout

      {Check 
\backslash

\backslash
 $X_{a_t,t}=Z_{
\backslash
tilde{a}_t,t}$?};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[process,
 left=of decide] (play) 
\end_layout

\begin_layout Plain Layout

      {Play arm $a_t$ };
\end_layout

\begin_layout Plain Layout


\backslash
node[process,
 above=of play] (obsr) 
\end_layout

\begin_layout Plain Layout

      { Observe reward 
\backslash

\backslash
 $Y_{a_t,t}=W_{a_t,t}$ };
\end_layout

\begin_layout Plain Layout


\backslash
node[process,
 above=of obsr] (inct) 
\end_layout

\begin_layout Plain Layout

      { $t
\backslash
gets t+1$ };
\end_layout

\begin_layout Plain Layout

% Arrows --------------------------------------------------------
\end_layout

\begin_layout Plain Layout


\backslash
draw[->] (theta)   -- (observe);
\end_layout

\begin_layout Plain Layout


\backslash
draw[->] (observe) -- (pi);
\end_layout

\begin_layout Plain Layout


\backslash
draw[->] (pi) -- (sampleA);
\end_layout

\begin_layout Plain Layout


\backslash
draw[->] (sampleA) -- (compZ);
\end_layout

\begin_layout Plain Layout


\backslash
draw[->] (compZ)   -- (sampleC);
\end_layout

\begin_layout Plain Layout


\backslash
draw[->] (sampleC) -- (decide);
\end_layout

\begin_layout Plain Layout


\backslash
draw[->] (decide)  -- node[above]{yes} (play);
\end_layout

\begin_layout Plain Layout


\backslash
draw[->] (decide)  |- node[above]{no} (sampleA);
  % loop back on "no"
\end_layout

\begin_layout Plain Layout


\backslash
draw[->] (play)    -- (obsr);
\end_layout

\begin_layout Plain Layout


\backslash
draw[->] (obsr)    -- (inct);
\end_layout

\begin_layout Plain Layout


\backslash
draw[->] (inct)    -- (theta);
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Flow diagram of the proposed coupling and resampling scheme
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:process"

\end_inset

 
\begin_inset VSpace 5pt
\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This section introduces a probabilistic method to couple the hypothetical bandit problem with the original contextual bandit.
 Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:process"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 illustrates the overall coupling and resampling process.
 The key observation is that the hypothetical pseudo-reward in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:HDRY"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 is computable under the event 
\begin_inset Formula $\{Z_{\tilde{a}_{s},s}=X_{a_{s},s}\}$
\end_inset

,
 which is implied by 
\begin_inset Formula $\{\tilde{a}_{s}=N_{s}\}$
\end_inset

.
 To ensure this condition,
 we resample both 
\begin_inset Formula $a_{s}\sim\pi_{s}$
\end_inset

 and 
\begin_inset Formula $\tilde{a}_{s}\sim\tilde{\pi}_{s}$
\end_inset

 using the distribution in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:pseudo_prob"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
Each resampling iteration generates updated hypothetical contexts 
\begin_inset Formula $\{Z_{i,s}:i\in[N_{s}]\}$
\end_inset

,
 effectively randomizing the hypothetical contexts and rewards until the pseudo-reward becomes computable.
 Although rewards are collected from the original bandit,
 the estimation of the parameter 
\begin_inset Formula $\theta_{\star}$
\end_inset

 is performed using compressed and augmented samples from the hypothetical bandit problem.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\tilde{a}_{s}(m)$
\end_inset

 and 
\begin_inset Formula $a_{s}(m)$
\end_inset

 denote the actions sampled during the 
\begin_inset Formula $m$
\end_inset

-th resampling trial in the hypothetical and original bandits,
 respectively.
 These actions are IID across trials 
\begin_inset Formula $m$
\end_inset

 given 
\begin_inset Formula $\Hcal_{t}$
\end_inset

.
 Define the stopping time for successful coupling as 
\begin_inset Formula $\xi_{s}:=\inf\{m\geq1:X_{a_{s}(m)}=Z_{\tilde{a}_{s}(m)}\}$
\end_inset

.
 Then,
 define the matching event:
 
\begin_inset Formula 
\begin{equation}
\mathcal{M}_{s}:=\{\xi_{s}\leq M_{s}\},\quad M_{s}:=\left\lceil \frac{\log((s+1)^{2}/\delta)}{\log(1/(1-\gamma))}\right\rceil \label{eq:matching_event}
\end{equation}

\end_inset

which ensures a successful coupling within 
\begin_inset Formula $M_{s}$
\end_inset

 trials.
 Since 
\begin_inset Formula $\mathbb{P}(\tilde{a}_{s}(m)=N_{s})=\gamma$
\end_inset

,
 the number of trials 
\begin_inset Formula $M_{s}$
\end_inset

 is selected to guarantee 
\begin_inset Formula $\mathbb{P}(\mathcal{M}_{s})\geq1-\delta/(s+1)^{2}$
\end_inset

.
\end_layout

\begin_layout Standard
The hyperparameter 
\begin_inset Formula $\gamma$
\end_inset

 controls the trade-off:
 as 
\begin_inset Formula $\gamma$
\end_inset

 increases,
 the probability of coupling success increases (thus requiring fewer resampling trials),
 while the size of the regularization set 
\begin_inset Formula $h_{t}$
\end_inset

 must increase.
 Table
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "tab:coupling"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 illustrates the data structures for successful and failed couplings during resampling.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement t
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="6">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" rightline="true" usebox="none" special="c|">
\begin_inset Text

\begin_layout Plain Layout
Hypothetical Bandit Problem
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout
Original Bandit Problem
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Arm 1 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Arm 2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Arm 1 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Arm 2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Arm 3 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Failure 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
cellcolor{Gray}
\end_layout

\end_inset


\begin_inset Formula $(Z_{\tilde{a}_{t},t},W_{\tilde{a}_{t},t})$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(Z_{N_{t},t},?)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(X_{1,t},?)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(X_{2,t},?)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
cellcolor{Gray}
\end_layout

\end_inset


\begin_inset Formula $(X_{a_{t},t},Y_{a_{t},t})$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Success 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(Z_{1,t},?)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
cellcolor{Gray}
\end_layout

\end_inset


\begin_inset Formula $(Z_{N_{t},t},W_{N_{t},t})$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(X_{1,t},?)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
cellcolor{Gray}
\end_layout

\end_inset


\begin_inset Formula $(X_{a_{t},t},Y_{a_{t},t})$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(X_{3,t},?)$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Illustration of coupling success and failure during resampling for 
\begin_inset Formula $N_{t}=2$
\end_inset

 and 
\begin_inset Formula $K=3$
\end_inset

.
 By construction,
 
\begin_inset Formula $Z_{2,t}:=X_{a_{t},t}$
\end_inset

 and 
\begin_inset Formula $W_{2,t}:=Y_{a_{t},t}$
\end_inset

.
 Gray cells indicate the selected actions.
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "tab:coupling"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%------------------ Sub-algorithm ------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float algorithm
placement t
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Candidate-Arm Sampler (
\family typewriter
CAS
\family default
) for Round 
\begin_inset Formula $t$
\end_inset


\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "alg:cas"

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{algorithmic}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

1
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\series bold
Input:

\series default
 contexts 
\begin_inset Formula $\{X_{k,t}\}_{k\in[K]}$
\end_inset

,
 posterior mean 
\begin_inset Formula $\widehat{\theta}_{t-1}$
\end_inset

,
 exploration variance 
\begin_inset Formula $v_{t-1}$
\end_inset

,
 Gram matrix 
\begin_inset Formula $V_{t-1}$
\end_inset

,
 pseudo-index 
\begin_inset Formula $N_{t}$
\end_inset

,
 coupling parameter 
\begin_inset Formula $\gamma$
\end_inset

,
 confidence 
\begin_inset Formula $\delta$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\series bold
Set
\series default
 
\begin_inset Formula $M_{t}$
\end_inset

 as in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:matching_event"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 
\begin_inset space \hfill{}
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
COMMENT
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

// maximum retries
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\series bold
Initialise
\series default
 
\begin_inset Formula $m\gets1$
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
REPEAT
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Sample 
\begin_inset Formula $\tilde{\theta}_{k,t}^{(m)}\sim\mathcal{N}\!\bigl(\widehat{\theta}_{t-1},\,v_{t-1}^{2}V_{t-1}^{-1}\bigr)$
\end_inset

 independently for all 
\begin_inset Formula $k\in[K]$
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $a_{t}^{(m)}\gets\arg\max_{k\in[K]}X_{k,t}^{\top}\tilde{\theta}_{k,t}^{(m)}$
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Sample 
\begin_inset Formula $\tilde{a}_{t}^{(m)}$
\end_inset

 from the distribution in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:pseudo_prob"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $m\gets m+1$
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
UNTIL
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $\tilde{a}_{t}^{(m-1)}=N_{t}\;\;\mathbf{or}\;\;m>M_{t}$
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\series bold
Output:

\series default
 
\begin_inset Formula $a_{t}^{\star}\gets a_{t}^{(m-1)}$
\end_inset

,
 
\begin_inset space \quad{}
\end_inset


\begin_inset Formula $\tilde{a}_{t}^{\star}\gets\tilde{a}_{t}^{(m-1)}$
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%----------------------------------------------------
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The proposed resampling-coupling scheme is describe in Algorithm
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "alg:cas"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 as candidate arm sampler (
\family typewriter
CAS
\family default
).
 The resampling in 
\family typewriter
CAS
\family default
 is distinctive from that in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2021doubly}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{xu2020upper}
\end_layout

\end_inset

.
 The resampling in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2021doubly}
\end_layout

\end_inset

 resamples the action to find the arm whose selection probability is greater than a prespecified threshold value.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{xu2020upper}
\end_layout

\end_inset

 resamples the previous counterfactual actions and contexts to impose randomization and generalization on the estimator.
 In contrast,
 our resampling is to couple the hypothetical samples with the original samples and this coupling is the first method a novel innovative part in this work.
\end_layout

\begin_layout Standard
Upon obtaining the coupled contexts 
\begin_inset Formula $Z_{\tilde{a}_{s}(M_{s}),s}=X_{a_{s}(M_{s}),s}$
\end_inset

,
 we construct the coupled pseudo-reward as:
 
\begin_inset Formula 
\begin{equation}
W_{i,s}^{Co(\check{\theta}_{t})}:=\left(1-\frac{\mathbb{I}(\tilde{a}_{s}(M_{s})=i)}{\phi_{i,s}}\right)Z_{i,s}^{\top}\check{\theta}_{t}+\frac{\mathbb{I}(\tilde{a}_{s}(M_{s})=i)}{\phi_{i,s}}W_{i,s},\label{eq:CoY}
\end{equation}

\end_inset

which is computable for all 
\begin_inset Formula $i\in[N_{s}]$
\end_inset

 because 
\begin_inset Formula $a_{s}(M_{s})$
\end_inset

 is selected and 
\begin_inset Formula $W_{\tilde{a}_{s}(M_{s}),s}=Y_{a_{s}(M_{s}),s}$
\end_inset

 is observable.
\end_layout

\begin_layout Standard
Given an reference estimator 
\begin_inset Formula $\check{\theta}_{t}$
\end_inset

 defined in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:impute"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 the proposed 
\emph on
hypothetical coupled sample augmented
\emph default
 (HCSA) estimator is defined as:
 
\begin_inset Formula 
\begin{equation}
\widehat{\theta}_{t}:=\left\{ \sum_{s=1}^{t}\mathbb{I}(\mathcal{M}_{s})\sum_{i=1}^{N_{s}}Z_{i,s}Z_{i,s}^{\top}\right\} ^{-1}\left(\sum_{s=1}^{t}\mathbb{I}(\mathcal{M}_{s})\sum_{i=1}^{N_{s}}W_{i,s}^{Co(\check{\theta}_{t})}Z_{i,s}\right).\label{eq:A_estimator}
\end{equation}

\end_inset

The indicator 
\begin_inset Formula $\II(\Mcal_{s})$
\end_inset

 makes the estimator use the coupled pseudo-rewards
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CoY"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 only when 
\begin_inset Formula $\mathcal{M}_{s}$
\end_inset

 occurs;
 otherwise,
 it skips round 
\begin_inset Formula $s$
\end_inset

 and relies on the previous estimator.
 Since 
\begin_inset Formula $\mathcal{M}_{s}$
\end_inset

 occurs with high probability,
 we can couple the HCSA estimator with the hypothetical sample augmented estimator from
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Hypo_DR"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
While the DR estimator in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DR_estimator"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 where the 
\begin_inset Formula $K$
\end_inset

 pseudo-rewards are augmented,
 the proposed (HCSA) estimator
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Hypo_DR"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 adds 
\begin_inset Formula $N_{s}\le d+1$
\end_inset

 for each round 
\begin_inset Formula $s\in[t]$
\end_inset

.
 This reduction in the number of augmented pseudo-reward samples paves a way to reduce the error and eliminate the IID and minimum eigenvalue assumption on contexts,
 by which 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2021doubly}
\end_layout

\end_inset

 used to obtain a regret bound that depends on the minimum eigenvalue of the context covariance.
\end_layout

\begin_layout Standard
Next,
 we provide a coupling inequality that relates the HCSA estimator to hypothetical sample augmented estimator 
\begin_inset Formula $\tilde{\theta}_{t}^{H(\check{\theta}_{t})}$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{lemma}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

A coupling inequality
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "lem:coupling"

\end_inset

 For 
\begin_inset Formula $t\geq1$
\end_inset

,
 let 
\begin_inset Formula $\Scal_{t}:=\cap_{s=1}^{t}\Mcal_{s}$
\end_inset

,
 where 
\begin_inset Formula $\Mcal_{s}$
\end_inset

 is the matching event defined in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:matching_event"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 For the reference estimator 
\begin_inset Formula $\check{\theta}_{t}$
\end_inset

 defined in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:impute"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 and for 
\begin_inset Formula $x>0$
\end_inset

,
 
\begin_inset Formula 
\[
\PP\left(\left\{ \norm{\widehat{\theta}_{t}^{A(\check{\theta}_{t})}-\theta_{\star}}_{\Gb_{t}}>x\right\} \right)\leq\PP\left(\left\{ \norm{\tilde{\theta}_{t}^{H(\check{\theta}_{t})}-\theta_{\star}}_{\Gb_{t}}>x\right\} \cap\Scal_{t}\right)+\PP(\Scal_{t}^{c}),
\]

\end_inset

and the failure probability satisfies 
\begin_inset Formula $\PP(\Scal_{t}^{c})\leq\delta$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{lemma}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
Fix 
\begin_inset Formula $t\in[T]$
\end_inset

 throughout the proof.
 For any 
\begin_inset Formula $\check{\theta}\in\RR^{d}$
\end_inset

 and 
\begin_inset Formula $x>0$
\end_inset

,
 decompose the probability as follows:
 
\begin_inset Formula 
\[
\PP\left(\norm{\widehat{\theta}_{t}-\theta_{\star}}_{\Gb_{t}}>x\right)\leq\PP\left(\left\{ \norm{\widehat{\theta}_{t}-\theta_{\star}}_{\Gb_{t}}>x\right\} \cap\Scal_{t}\right)+\PP\left(\Scal_{t}^{c}\right).
\]

\end_inset

On the event 
\begin_inset Formula $\Scal_{t}:=\cap_{s=1}^{t}\Mcal_{s}$
\end_inset

,
 the HCSA estimator in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:A_estimator"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 is simplified to 
\begin_inset Formula 
\[
\widehat{\theta}_{t}^{A(\check{\theta}_{t})}=\left\{ \sum_{s=1}^{t}\sum_{i=1}^{N_{s}}Z_{i,s}Z_{i,s}^{\top}\right\} ^{-1}\left(\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}W_{i,s}^{Co(\check{\theta}_{t})}Z_{i,s}\right)=\Gb_{t}\left(\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}W_{i,s}^{Co(\check{\theta}_{t})}Z_{i,s}\right).
\]

\end_inset

Define the function 
\begin_inset Formula 
\[
F\Bigl(\tilde{a}_{1}(M_{1}),\ldots,\tilde{a}_{t}(M_{t})\Bigr):=\norm{\widehat{\theta}_{t}-\theta_{\star}}_{\Gb_{t}}=\norm{\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}(W_{i,s}^{Co(\check{\theta}_{t})}-Z_{i,s}^{\top}\theta_{\star})Z_{i,s}}_{\Gb_{t}}.
\]

\end_inset

Using the definition of 
\begin_inset Formula $M_{s}$
\end_inset

,
 where 
\begin_inset Formula $\tilde{a}_{s}(M_{s})=N_{s}$
\end_inset

,
 we have 
\begin_inset Formula 
\begin{align*}
 & \PP\left(\left\{ F\Bigl(\tilde{a}_{1}(M_{1}),\ldots,\tilde{a}_{t}(M_{t})\Bigr)>x\right\} \cap\Scal_{t}\right)\\
 & =\PP\left(\left\{ F\Bigl(\tilde{a}_{1}(M_{1}),\ldots,\tilde{a}_{t}(M_{t})\Bigr)>x\right\} \cap\Scal_{t}\cap\bigcap_{s=1}^{t}\{\tilde{a}_{s}(M_{s})=N_{s}\}\right)\\
 & =\PP\left(\left\{ F\Bigl(\tilde{a}_{1}(1),\ldots,\tilde{a}_{t}(1)\Bigr)>x\right\} \cap\Scal_{t}\cap\bigcap_{s=1}^{t}\{\tilde{a}_{s}(1)=N_{s}\}\right),
\end{align*}

\end_inset

where the last equality holds because 
\begin_inset Formula $\{\tilde{a}_{s}(m):m\in\NN\}$
\end_inset

 are IID for each 
\begin_inset Formula $s\in[t]$
\end_inset

.
 Then,
 
\begin_inset Formula 
\begin{align*}
 & \PP\left(\left\{ F\Bigl(\tilde{a}_{1}(1),\ldots,\tilde{a}_{t}(1)\Bigr)>x\right\} \cap\Scal_{t}\cap\bigcap_{s=1}^{t}\{\tilde{a}_{s}(1)=N_{s}\}\right)\\
 & \leq\PP\left(\left\{ F\Bigl(\tilde{a}_{1}(1),\ldots,\tilde{a}_{t}(1)\Bigr)>x\right\} \cap\Scal_{t}\right)
\end{align*}

\end_inset

Replacing 
\begin_inset Formula $\{\tilde{a}_{s}(M_{s}):s\in[t]\}$
\end_inset

 in coupled pseudo-rewards
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CoY"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 with 
\begin_inset Formula $\{\tilde{a}_{s}(1):s\in[t]\}$
\end_inset

 gives the hypothetical pseudo-rewards in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:HDRY"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 Thus,
 the distribution of the normalized error 
\begin_inset Formula $\|\tilde{\theta}_{t}^{H(\check{\theta}_{t})}-\theta_{\star}\|_{\Gb_{t}}$
\end_inset

 is equivalent to that of 
\begin_inset Formula $F\bigl(\tilde{a}_{1}(1),\ldots,\tilde{a}_{t}(1)\bigr)$
\end_inset

 and we obtain 
\begin_inset Formula 
\[
\PP\Big(\big\{ F\bigl(\tilde{a}_{1}(1),\ldots,\tilde{a}_{t}(1)\bigr)>x\big\}\cap\Scal_{t}\Big)=\PP\Big(\big\{\|\tilde{\theta}_{t}^{H(\check{\theta}_{t})}-\theta_{\star}\|_{\Gb_{t}}>x\big\}\cap\Scal_{t}\Big),
\]

\end_inset

which proves the coupling inequality.
 The bound for the failure probability 
\begin_inset Formula $\PP(\Scal_{t}^{c})\le\delta$
\end_inset

 is proved by the fact that 
\begin_inset Formula $\PP(\Mcal_{s}^{c})\le\delta/(s+1)^{2}$
\end_inset

 by construction of the maximum number of resampling trials.
 
\end_layout

\begin_layout Standard
With the coupling inequality,
 we can leverage augmented samples from the hypothetical bandit problem to closely approximate the hypothetical sample augmented estimator with high probability.
 While the coupling technique can be applied to any choice of hypothetical problem —
 and the hypothetical contexts 
\begin_inset Formula $\{Z_{i,t}\}$
\end_inset

 may be arbitrarily defined —
 it is crucial that they are compatible with the original contextual bandit problem and the reference estimator 
\begin_inset Formula $\check{\theta}_{t}$
\end_inset

.
\end_layout

\begin_layout Standard
The design of suitable hypothetical contexts is key,
 as it enables control of the maximum deviation in the original problem through the bound:
 
\begin_inset Formula 
\[
\max_{k\in[K]}\left|X_{k,t}^{\top}\left(\tilde{\theta}_{t}^{H(\check{\theta}_{t})}-\theta_{\star}\right)\right|\le\norm{\tilde{\theta}_{t}^{H(\check{\theta}_{t})}-\theta_{\star}}_{\tilde{G}_{t}}\cdot\max_{k\in[K]}\norm{X_{k,t}}_{\tilde{G}_{t}^{-1}},
\]

\end_inset

where 
\begin_inset Formula $\tilde{G}_{t}:=\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}Z_{i,s}Z_{i,s}^{\top}$
\end_inset

 denotes the Gram matrix constructed from the hypothetical contexts.
\end_layout

\begin_layout Standard
This upper bound consists of two components:
 (i) the self-normalized error of the hypothetical sample augmented estimator,
 and (ii) the maximum norm of the original contexts normalized by 
\begin_inset Formula $\tilde{G}_{t}$
\end_inset

.
 Each component is sensitive to how the Gram matrix 
\begin_inset Formula $\tilde{G}_{t}$
\end_inset

 is constructed.
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\tilde{G}_{t}$
\end_inset

 is defined using only the played contexts —
 i.e.,
 
\begin_inset Formula $\tilde{G}_{t}=\sum_{s=1}^{t}X_{a_{s},s}X_{a_{s},s}^{\top}+I_{d}$
\end_inset

 —
 then the norm term 
\begin_inset Formula $\max_{k\in[K]}\|X_{k,t}\|_{\tilde{G}_{t}^{-1}}$
\end_inset

 may become unbounded due to insufficient exploration.
 Conversely,
 if 
\begin_inset Formula $\tilde{G}_{t}$
\end_inset

 is constructed from an overly large set of hypothetical contexts,
 the self-normalized error 
\begin_inset Formula $\|\tilde{\theta}_{t}^{H(\check{\theta}_{t})}-\theta_{\star}\|_{\tilde{G}_{t}}$
\end_inset

 may increase significantly,
 making it harder to guarantee tight estimation bounds.
\end_layout

\begin_layout Standard
Therefore,
 the design of the hypothetical contexts must carefully balance the number of augmenting samples to ensure both the estimator's accuracy and the tightness of high-probability bounds.
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:self"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 presents a formal analysis of this trade-off,
 and shows that the proposed construction achieves this balance effectively,
 leading to a well-conditioned estimator with high-probability regret guarantees.
\end_layout

\begin_layout Subsection
Hypothetical Coupled Sample Augmented Thompson Sampling
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:algorithm"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement t
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Hypothetical Coupled Sample Augmented Thompson Sampling (
\family typewriter
HCSA+TS
\family default
)
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "alg:ATS"

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{algorithmic}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

1
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\series bold
Input:

\series default
 confidence level 
\begin_inset Formula $\delta\in(0,1)$
\end_inset

,
 coupling parameter 
\begin_inset Formula $\gamma\in(0,1)$
\end_inset

,
 exploration parameter 
\begin_inset Formula $\Gb_{t}:=\{2\log\frac{K(t+1)^{2}}{\delta}\}^{-1/2}$
\end_inset

,
 orthogonal basis regularization parameter 
\begin_inset Formula $h_{t}$
\end_inset

 as in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:h_t"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Initialize the estimator 
\begin_inset Formula $\widehat{\theta}_{0}=\mathbf{0}$
\end_inset

,
 Gram matrix 
\begin_inset Formula $V_{0}=O$
\end_inset

,
 and a subset of rounds for the orthogonal basis regularization 
\begin_inset Formula $\mA_{0}=\emptyset$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
FOR
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $t=1$
\end_inset

 
\series bold
to
\series default
 
\begin_inset Formula $T$
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Observe contexts 
\begin_inset Formula $\{X_{k,t}:k\in[K]\}$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Update 
\begin_inset Formula $\Acal_{t}$
\end_inset

 as in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:A"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 and compute 
\begin_inset Formula $N_{t}$
\end_inset

 as in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Set 
\begin_inset Formula $m=1$
\end_inset

 sample 
\begin_inset Formula $\tilde{a}_{t}(m)$
\end_inset

 from the multinomial distribution 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:pseudo_prob"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $(a_{t}(m),\tilde{a}_{t}(m))\gets\texttt{CAS}\bigl(\{X_{k,t}\},\widehat{\theta}_{t-1},v_{t-1},V_{t-1},N_{t},\gamma,\delta\bigr)$
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
IF
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $\tilde{a}_{t}(m)=N_{t}$
\end_inset

 // Resampling succeeded
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Pull arm 
\begin_inset Formula $a_{t}(m)$
\end_inset

 and observe 
\begin_inset Formula $Y_{a_{t}(m),t}$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Compute the reference estimator 
\begin_inset Formula $\check{\theta}_{t}$
\end_inset

 defined in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:impute"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
IF
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $t\in\Acal_{t}$
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Compute hypothetical contexts 
\begin_inset Formula $Z_{i,t}:=H_{i,t}$
\end_inset

 as in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:new_contexts"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
ELSE
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Compute hypothetical contexts 
\begin_inset Formula $Z_{i,t}:=\tilde{H}_{i,t}$
\end_inset

 with orthogonal basis as in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:new_contexts"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
ENDIF
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Update 
\begin_inset Formula $\Gb_{t}=V_{t-1}+\sum_{i=1}^{N_{t}}Z_{i,s}Z_{i,s}^{\top}$
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 Compute the estimator 
\begin_inset Formula $\widehat{\theta}_{t}$
\end_inset

 as in 
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:A_estimator"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
ELSE
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\widehat{\theta}_{t}\leftarrow\widehat{\theta}_{t-1}$
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
ENDIF
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
ENDFOR
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The proposed algorithm,
 
\shape italic
Hypothetical Coupled Sample Augmented Thompson Sampling
\shape default
 (
\family typewriter
HCSA+TS
\family default
),
 is detailed in Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:ATS"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 This algorithm builds upon the structure of 
\family typewriter
LinTS
\family default
 but introduces two key innovations:
 (i) resampling to couple the hypothetical bandit with the original bandit,
 and (ii) the HCSA estimator,
 which leverages a compressed orthogonal basis for improved efficiency.
\end_layout

\begin_layout Standard
For the resampling step (i),
 the algorithm repeatedly resamples 
\begin_inset Formula $a_{t}$
\end_inset

 from 
\family typewriter
LinTS
\family default
 policy equipped with HCSA estimator and the novel Gram matrix until the condition 
\begin_inset Formula $\{Z_{\tilde{a}_{t},t}=X_{a_{t},t}\}$
\end_inset

 is satisfied.
 This ensures that the hypothetical bandit aligns with the original bandit by augmenting the randomized contexts.
 The number of resampling attempts,
 set to 
\begin_inset Formula $\lceil\log\frac{(t+1)^{2}}{\delta}/\log\frac{1}{1-\gamma}\rceil$
\end_inset

,
 guarantees the resampling process succeeds with probability at least 
\begin_inset Formula $1-\delta/(t+1)^{2}$
\end_inset

.
 In practice,
 this resampling typically succeeds after only a few iterations.
\end_layout

\begin_layout Standard
For the HCSA estimator (ii),
 although computing it might appear computationally demanding,
 efficient implementation strategies significantly reduce its complexity.
 Theoretically,
 the algorithm must compute hypothetical context vectors 
\begin_inset Formula $\{Z_{i,t}:i\in[N_{t}]\}$
\end_inset

 for each resampling iteration.
 However,
 in practice,
 the algorithm first checks if 
\begin_inset Formula $\{\tilde{a}_{t}=N_{t}\}$
\end_inset

 occurs and then computes the hypothetical contexts based on the resampled 
\begin_inset Formula $a_{t}$
\end_inset

.
\end_layout

\begin_layout Standard
The worst-case computational complexity of the algorithm is 
\begin_inset Formula $O(d^{2}(K+d)T+T\log(T+1)/\log(\frac{1}{1-\gamma}))$
\end_inset

.
 The primary computational bottleneck arises from calculating the Gram matrix 
\begin_inset Formula $\Gb_{t}$
\end_inset

 and performing eigenvalue decomposition to construct hypothetical contexts,
 repeated for the specified number of resampling attempts in each round 
\begin_inset Formula $t\in[T]$
\end_inset

.
 In practice,
 the computational efficiency of the A estimator can be further enhanced by applying the Sherman-Morrison formula,
 enabling rank-1 updates and reducing memory usage.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

% 5.
 Regret Analysis
\end_layout

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\end_inset


\end_layout

\begin_layout Section
Regret Analysis
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:regret_analysis"

\end_inset

 The following theorem establishes a nearly minimax-optimal cumulative regret bound for the 
\family typewriter
HCSA+TS
\family default
 algorithm.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{theorem}[Regret Bound for 
\backslash
textttHCSA+TS]
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "thm:regret_bound"

\end_inset

 In Algorithm
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "alg:ATS"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 set the exploration parameter as 
\begin_inset Formula $\Gb_{t}=\{2\log(K(t+1)^{2}/\delta)\}^{-1/2}$
\end_inset

.
 Then,
 with probability at least 
\begin_inset Formula $1-3\delta$
\end_inset

,
 the cumulative regret of the 
\family typewriter
HCSA+TS
\family default
 algorithm by round 
\begin_inset Formula $T$
\end_inset

 satisfies:
 
\begin_inset Formula 
\begin{equation}
R(T)\leq\frac{4d}{(1/2-e^{-1})(1-\gamma)}\log\frac{d(T+1)^{2}}{\delta}+\left\{ 20\sqrt{2}\theta_{\max}+\frac{21\sigma}{\gamma}\sqrt{2d\log\frac{2T}{\delta}}+1\right\} \sqrt{8dT\log\frac{T}{d}}.\label{eq:regret_bound}
\end{equation}

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{theorem}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The leading order term of the regret bound is 
\begin_inset Formula $O(d\sqrt{T}\log T)$
\end_inset

,
 which matches the minimax lower bound 
\begin_inset Formula $\Omega(d\sqrt{T})$
\end_inset

 established in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{lattimore2020bandit}
\end_layout

\end_inset

,
 up to logarithmic factors.
 This result provides the first nearly minimax-optimal regret guarantee for linear contextual bandits under arbitrary context distributions.
\end_layout

\begin_layout Standard
For comparison,
 
\begin_inset CommandInset citation
LatexCommand cite
key "kim2021doubly"
literal "false"

\end_inset

 achieved 
\begin_inset Formula $\tilde{O}(d\sqrt{T})$
\end_inset

 regret bound under IID contexts with some special distributions of which the minimum eigenvalue of the average covariance matrix is 
\begin_inset Formula $\Omega(1/d)$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2023squeeze}
\end_layout

\end_inset

 achieved a regret bound of 
\begin_inset Formula $O(\sqrt{dT\log T})$
\end_inset

 under the assumption of IID contexts with a strictly positive minimum eigenvalue for their average covariance matrix.
 Similarly,
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{huix2023tight}
\end_layout

\end_inset

 obtained a regret bound of 
\begin_inset Formula $\tilde{O}(d\sqrt{T})$
\end_inset

,
 but their analysis assumes a Gaussian prior on the unknown parameter 
\begin_inset Formula $\theta_{\star}$
\end_inset

.
\end_layout

\begin_layout Standard
Earlier works such as 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2021doubly}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{agrawal2013thompson}
\end_layout

\end_inset

 impose unit-norm assumptions on the contexts.
 In contrast,
 the regret bound
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:regret_bound"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 does not require normalization of the context vectors.
 The only assumption made is that the absolute inner product between any context and the true parameter is bounded,
 i.e.,
 
\begin_inset Formula $|X_{k,t}^{\top}\theta_{\star}|\leq1$
\end_inset

.
 Notably,
 increasing the context norm bound 
\begin_inset Formula $x_{\max}$
\end_inset

 does not cause the regret to grow linearly,
 avoiding the scaling issues encountered in prior analyses.
\end_layout

\begin_layout Standard
The key technical contributions enabling this result include:
 (i) the development of a self-normalized bound for the HCSA estimator using a carefully constructed Gram matrix (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:self"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

),
 (ii) the identification of a set of low-regret arms selected with high probability (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:low_regret_arms"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

),
 and (iii) a novel maximal elliptical potential bound based on the augmented Gram matrix 
\begin_inset Formula $\Gb_{t}$
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:max_elliptical"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Subsection
A Self-Normalized Bound for the Proposed Estimator
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:self"

\end_inset

 With the coupling inequality (Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:coupling"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

),
 we can bound the error of the proposed estimator by obtaining an error bound for the hypothetical estimator
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Hypo_DR"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 which is proven in the following lemma.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{lemma}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

A self-normalized bound of the HSA estimator
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "lem:error_decomposition"

\end_inset

 For each 
\begin_inset Formula $t\ge1$
\end_inset

,
 define the matrix 
\begin_inset Formula $A_{t}:=\sum_{s=1}^{t}\phi_{\tilde{a}_{s},s}^{-1}Z_{\tilde{a}_{s},s}Z_{\tilde{a}_{s},s}^{\top}$
\end_inset

.
 and.
 Then the self-normalized bound of the hypothetical sample augmented estimator is decomposed as:
 
\begin_inset Formula 
\[
\norm{\tilde{\theta}_{t}^{H(\check{\theta}_{t})}-\theta_{\star}}_{\Gb_{t}}\le\norm{\Gb_{t}^{-1/2}(\Gb_{t}-A_{t})(\check{\theta}_{t}-\theta_{\star})}_{2}+\norm{\sum_{s=1}^{t}\phi_{\tilde{a}_{s},s}^{-1}(W_{\tilde{a}_{s},s}-Z_{\tilde{a}_{s},s}^{\top}\theta_{\star})Z_{\tilde{a}_{s},s}}_{\Gb_{t}}
\]

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{lemma}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The proof is in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:error_decomposition_proof"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 The decomposition shows the two sources of error for the HDR estimator for rewards of all arms:
 (i) from the reference estimator 
\begin_inset Formula $\check{\theta}$
\end_inset

 used as an reference estimator in HDR pseudo-rewards
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:HDRY"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 and (ii) the noise error of the rewards.
 In error term (i),
 
\begin_inset Formula $\Gb_{t}(\Gb_{t}-A_{t})$
\end_inset

 is the matrix martingale with bounded eigenvalues,
 which is bounded by the newly developed matrix concentration inequality (Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:matrix_neg"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
 The error term (ii) is bounded by a modified martingale inequality developed by 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{abbasi2011improved}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
With the suitable choice of 
\begin_inset Formula $\check{\theta}_{t}$
\end_inset

 as in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:impute"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 we obtain an 
\begin_inset Formula $O(\sqrt{d\log t})$
\end_inset

 error bound for 
\begin_inset Formula $\tilde{\theta}_{t}^{H(\check{\theta}_{t})}$
\end_inset

 estimator,
 which is normalized by the novel augmented Gram matrix 
\begin_inset Formula $\Gb_{t}$
\end_inset

 instead of the conventional Gram matrix that includes only selected contexts.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{theorem}[A Self-Normalized Bound for the HCSA Estimator]
\end_layout

\end_inset

 The HCSA estimator
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:A_estimator"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 satisfies,
 
\begin_inset Formula 
\[
\norm{\widehat{\theta}_{t}-\theta_{\star}}_{\Gb_{t}}\leq20\theta_{\max}+\frac{21\sigma}{\gamma}\sqrt{d\log\frac{1+t}{\delta}},
\]

\end_inset

with probability at least 
\begin_inset Formula $1-3\delta$
\end_inset

 for all 
\begin_inset Formula $t\geq T_{1}$
\end_inset

.
 
\begin_inset CommandInset label
LatexCommand label
name "thm:self"

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{theorem}
\end_layout

\end_inset

 The proof is provided in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:tail_proof"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 Unlike the conventional self-normalized bound of 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{abbasi2011improved}
\end_layout

\end_inset

,
 which is normalized by the Gram matrix 
\begin_inset Formula $\sum_{s=1}^{t}X_{a_{s},s}X_{a_{s},s}^{\top}+I_{d}$
\end_inset

 built solely from selected contexts,
 Theorem
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:self"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 establishes a bound normalized by the full Gram matrix 
\begin_inset Formula $\Gb_{t}$
\end_inset

,
 which includes contexts from all 
\begin_inset Formula $K$
\end_inset

 arms.
 While 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2023squeeze}
\end_layout

\end_inset

 also considered self-normalization with respect to a full Gram matrix,
 their estimator incorporates contexts from all arms only in a fraction of the rounds,
 and their analysis is restricted to IID contexts with a strictly positive-definite covariance matrix.
 In contrast,
 Theorem
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:self"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 applies to arbitrary (including non-IID,
 non-stationary) context sequences,
 establishing a uniform self-normalized bound with a full Gram matrix.
 This result enables a novel regret analysis of Thompson Sampling that yields a 
\begin_inset Formula $\tilde{O}(d\sqrt{T})$
\end_inset

 bound for 
\family typewriter
HCSA+TS
\family default
,
 applicable under arbitral context distributions.
\end_layout

\begin_layout Subsection
Low-Regret Arms with a High-Probability Guarantee
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:low_regret_arms"

\end_inset

 For each 
\begin_inset Formula $k\in[K]$
\end_inset

 and 
\begin_inset Formula $t\in[T]$
\end_inset

,
 define the instantaneous regret gap between the optimal arm and arm 
\begin_inset Formula $k$
\end_inset

 as 
\begin_inset Formula 
\[
\Delta_{k,t}:=X_{a_{t}^{\star},t}^{\top}\theta_{\star}-X_{k,t}^{\top}\theta_{\star}.
\]

\end_inset

Using this,
 we define the set of low-regret arms at round 
\begin_inset Formula $t$
\end_inset

 as 
\begin_inset Formula 
\begin{equation}
\mathcal{P}_{t}:=\left\{ k\in[K]:\Delta_{k,t}\le2x_{t}\norm{\widehat{\theta}_{t-1}-\theta_{\star}}_{\Gb_{t-1}}+\sqrt{\norm{X_{a_{t}^{\star},t}}_{\Gb_{t-1}^{-1}}^{2}+\norm{X_{k,t}}_{\Gb_{t-1}^{-1}}^{2}}\right\} ,\label{eq:low_regret_set}
\end{equation}

\end_inset

where 
\begin_inset Formula $x_{t}:=\max_{k\in[K]}\|X_{k,t}\|_{\Gb_{t-1}^{-1}}$
\end_inset

.
 The self-normalized confidence bound with respect to the hypothetical Gram matrix 
\begin_inset Formula $\Gb_{t-1}$
\end_inset

,
 which includes contexts beyond the selected arms,
 allows the construction of an effective set 
\begin_inset Formula $\mathcal{P}_{t}$
\end_inset

 that has lower regret than arms in sets built from Gram matrices based solely on selected contexts such as 
\begin_inset Formula $\sum_{s=1}^{t}X_{a_{s},s}X_{a_{s},s}^{\top}+I_{d}$
\end_inset

.
\end_layout

\begin_layout Standard
The following lemma provides a high-probability guarantee that the arm selected by Algorithm
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "alg:ATS"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 belongs to the low-regret set.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{lemma}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

High-Probability Selection of Low-Regret Arms
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "lem:super_unsaturated_arms"

\end_inset

 Let 
\begin_inset Formula $a_{t}$
\end_inset

 be the arm selected by Algorithm
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "alg:ATS"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 and let 
\begin_inset Formula $\mathcal{P}_{t}$
\end_inset

 be the set defined in
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:low_regret_set"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 If the exploration parameter is set as 
\begin_inset Formula $\Gb_{t}=\{2\log(K(t+1)^{2}/\delta)\}^{-1/2}$
\end_inset

,
 then 
\begin_inset Formula 
\[
\mathbb{P}\left(a_{t}\in\mathcal{P}_{t}\mid\mathcal{H}_{t}\right)\ge1-\frac{\delta}{(t+1)^{2}}.
\]

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{lemma}
\end_layout

\end_inset

 The proof is deferred to Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:low_regret_proof"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 In contrast to 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{agrawal2013thompson}
\end_layout

\end_inset

,
 where bounding the probability of selecting a saturated arm required setting 
\begin_inset Formula $v=\sqrt{9d\log(t/\delta)}$
\end_inset

,
 thereby introducing a 
\begin_inset Formula $\sqrt{d}$
\end_inset

-scaling,
 Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:super_unsaturated_arms"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 establishes that such dimensional dependence is unnecessary.
 By leveraging the structure of the HCSA estimator and its associated Gram matrix,
 the proposed approach guarantees high-probability selection of low-regret arms without incurring additional dependence of the variance parameter 
\begin_inset Formula $v$
\end_inset

 on the dimension 
\begin_inset Formula $d$
\end_inset


\end_layout

\begin_layout Subsection
Maximal Elliptical Potential Bound
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:max_elliptical"

\end_inset

 While continuing the proof of the regret bound,
 we face a novel terms that needs to be analyzed.
 By Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:super_unsaturated_arms"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 the algorithm selects arms from the low-regret set 
\begin_inset Formula $\Pcal_{t}$
\end_inset

,
 i.e.,
 
\begin_inset Formula $a_{t}\in\Pcal_{t}$
\end_inset

,
 with high probability.
 This leads to the following novel regret decomposition:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Regret{t}=\Diff{a_{t}}{t}\leq2x_{t}\norm{\Estimator{t-1}-\theta_{\star}}_{\Gb_{t-1}}+\sqrt{\norm{X_{a_{t}^{\star},t}}_{\Gb_{t-1}^{-1}}^{2}+\norm{X_{a_{t},t}}_{\Gb_{t-1}^{-1}}^{2}},
\]

\end_inset

for 
\begin_inset Formula $t\geq T_{1}$
\end_inset

.
 Thus,
 the cumulative regret is bounded as follows:
 
\begin_inset Formula 
\[
R(T)\leq2h_{T}+\sum_{t\in[T]\setminus\Acal_{T}}\left\{ 2x_{t}\norm{\Estimator{t-1}-\theta_{\star}}_{\Gb_{t-1}}+\sqrt{\norm{X_{a_{t}^{\star},t}}_{\Gb_{t-1}^{-1}}^{2}+\norm{X_{a_{t},t}}_{\Gb_{t-1}^{-1}}^{2}}\right\} .
\]

\end_inset

Because 
\begin_inset Formula $x_{t}:=\max_{k\in[K]}\|X_{k,t}\|_{V_{t-1}^{-1}}$
\end_inset

,
 we get:
 
\begin_inset Formula 
\[
R(T)\leq2h_{T}+\sum_{t\in[T]\setminus\Acal_{T}}\big(2x_{t}\|\Estimator{t-1}-\theta_{\star}\|_{\Gb_{t-1}}+\sqrt{2}x_{t}\big).
\]

\end_inset

Factoring out 
\begin_inset Formula $x_{t}$
\end_inset

:
 
\begin_inset Formula 
\[
R(T)\leq2T_{1}+\sum_{t=\in[T]\setminus\Acal_{T}}\big(2\|\Estimator{t-1}-\theta_{\star}\|_{\Gb_{t-1}}+\sqrt{2}\big)x_{t}.
\]

\end_inset

Since we obtain 
\begin_inset Formula $\|\Estimator{t-1}-\theta_{\star}\|_{V_{t-1}}=O(\sqrt{d\log t})$
\end_inset

 from Theorem
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "thm:self"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 we need a bound for 
\begin_inset Formula $\sum_{t\in[T]\setminus\Acal_{T}}x_{t}$
\end_inset

,
 which is in the following lemma.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{lemma}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

Maximal elliptical potential lemma
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "lem:elliptical"

\end_inset

 For 
\begin_inset Formula $x_{t}:=\max_{k\in[K]}\|X_{k,t}\|_{\Gb_{t-1}^{-1}}$
\end_inset

,
 we have:
 
\begin_inset Formula 
\[
\sum_{t=T_{1}}^{T}x_{t}^{2}\leq4d\log\frac{T}{d}.
\]

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{lemma}
\end_layout

\end_inset

 The proof is in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:proof_elliptical"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 Previous elliptical lemmas only obtain the bounds the normalized norm of the selected contexts 
\begin_inset Formula $X_{a_{t},t}$
\end_inset

,
 while we need a bound for 
\begin_inset Formula $\max_{k\in{K]}}\|X_{k,t}\|_{\Gb_{t-1}^{-1}}$
\end_inset

.
 The maximal elliptical potential lemma bounds the normalized norm of the contexts for all 
\begin_inset Formula $K$
\end_inset

 arms,
 which previous analyses could not bound effectively.
 This is possible because we augmented suitable sample to obtain the Gram matrix 
\begin_inset Formula $\Gb_{t}$
\end_inset

 consisting of contexts from all 
\begin_inset Formula $K$
\end_inset

 arms.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

% 6.
 Experimental Results
\end_layout

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Experimental Results
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:experiment"

\end_inset

 This section is for evaluating the empirical performance of the proposed algorithm,
 
\family typewriter
HCSA+TS
\family default
,
 against several benchmark algorithms for LinCB with simulated data.
 The benchmarks include 
\family typewriter
LinTS
\family default
,
 
\family typewriter
LinUCB
\family default
,
 
\family typewriter
DRTS
\family default
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{kim2021doubly}
\end_layout

\end_inset

,
 
\family typewriter
HyRan
\family default
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{kim2023squeeze}
\end_layout

\end_inset

,
 and 
\family typewriter
SupLinUCB
\family default
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{chu2011contextual}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%----------------------------------------
\end_layout

\begin_layout Plain Layout

% Figure 1.
 Regret comparison
\end_layout

\begin_layout Plain Layout

%----------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
placement t
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
subfigure[Regret comparison ($d=10$,
 $K=20$)]{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/Regrets_10dimension_20arms.png
	width 48text%

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
subfigure[Regret comparison ($d=30$,
 $K=20$)]{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/Regrets_30dimension_20arms.png
	width 48text%

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Newline newline
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
subfigure[Regret comparison ($d=10$,
 $K=30$)]{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/Regrets_10dimension_30arms.png
	width 48text%

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
subfigure[Regret comparison ($d=30$,
 $K=30$)]{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/Regrets_30dimension_30arms.png
	width 48text%

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:comparison"

\end_inset

 Comparison of the regrets of the proposed 
\family typewriter
HCSA+TS
\family default
 algorithm with other benchmark methods.
 The lines represent the average,
 and the shaded areas indicate the standard deviation based on twenty experiments.
 The results demonstrate that the proposed 
\family typewriter
HCSA+TS
\family default
 effectively identifies the optimal arm using orthogonal regularization.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%----------------------------------------
\end_layout

\begin_layout Plain Layout

% Figure 2.
 Prediction error
\end_layout

\begin_layout Plain Layout

%----------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
placement t
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
subfigure[Prediction error comparison ($d=10$,
 $K=20$)]{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/est_10dimension_20arms.png
	width 48text%

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset space \hfill{}
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
subfigure[Prediction error comparison ($d=30$,
 $K=20$)]{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/est_30dimension_20arms.png
	width 48text%

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Newline newline
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
subfigure[Prediction error comparison ($d=10$,
 $K=30$)]{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/est_10dimension_30arms.png
	width 48text%

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset space \hfill{}
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
subfigure[Prediction error comparison ($d=30$,
 $K=30$)]{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Graphics
	filename figures/est_30dimension_30arms.png
	width 48text%

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
vspace{.1in}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:prediction"

\end_inset

 Comparison of the prediction error across all arms,
 calculated as 
\begin_inset Formula $\sum_{i=1}^{K}\{X_{i,t}^{\top}(\widehat{\theta}_{t}-\theta_{\star})\}^{2}$
\end_inset

,
 for the proposed 
\family typewriter
HCSA+TS
\family default
 and other benchmark methods.
 The lines represent the averages,
 and the shaded areas indicate the standard deviations based on twenty experiments.
 The results demonstrate that the proposed estimator,
 enhanced with orthogonal augmentation,
 learns the reward more accurately than other estimators.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For the experiment setting,
 the parameter 
\begin_inset Formula $\theta_{\star}$
\end_inset

 is defined as:
 
\begin_inset Formula 
\[
\theta_{\star}:=\frac{1}{\sqrt{d}}\biggl(\underset{\lceil d/2\rceil}{\underbrace{1,\cdots,1}},\underset{d-\lceil d/2\rceil}{\underbrace{-1,\cdots,-1}}\biggr)^{\top},
\]

\end_inset

where 
\begin_inset Formula $d\in\{10,30\}$
\end_inset

 is the dimension of the parameter.
 The 
\begin_inset Formula $i$
\end_inset

-th entry of the context vectors for 
\begin_inset Formula $K\in\{20,30\}$
\end_inset

 arms are independently sampled from a Gaussian distribution with a mean of 
\begin_inset Formula $-1+\frac{3(i-1)}{d-1}$
\end_inset

 and variance of 1 for each 
\begin_inset Formula $i\in[d]$
\end_inset

.
 These vectors are normalized and then scaled by a scalar drawn uniformly from 
\begin_inset Formula $[0,1]$
\end_inset

.
 To simulate missing context information,
 with probability 
\begin_inset Formula $1/2$
\end_inset

,
 the last 
\begin_inset Formula $d-\lceil d/2\rceil$
\end_inset

 entries of the context vectors are set to zero at each round.
 This setting reflects practical scenarios where certain context features may be unavailable with some probability,
 making it challenging to estimate the corresponding entries in 
\begin_inset Formula $\theta_{\star}$
\end_inset

.
\end_layout

\begin_layout Standard
The hyperparameter optimization was conducted as follows:
 For 
\family typewriter
LinTS
\family default
,
 the variance parameter was selected from 
\begin_inset Formula $\{0.01,0.1,1\}$
\end_inset

.
 For 
\family typewriter
LinUCB
\family default
 and 
\family typewriter
SupLinUCB
\family default
,
 the confidence bound inflation parameter was chosen from 
\begin_inset Formula $\{0.01,0.1,1\}$
\end_inset

.
 For 
\family typewriter
HyRan
\family default
 and 
\family typewriter
HCSA+TS
\family default
,
 the regularization parameters 
\begin_inset Formula $p$
\end_inset

 and 
\begin_inset Formula $\gamma$
\end_inset

 (only 
\begin_inset Formula $\gamma$
\end_inset

 for 
\family typewriter
HCSA+TS
\family default
) were tuned from 
\begin_inset Formula $\{0.1,0.5,0.9\}$
\end_inset

.
 The hyperparameters for 
\family typewriter
DRTS
\family default
 were fixed as specified in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2021doubly}
\end_layout

\end_inset

.
 Values outside the specified ranges showed negligible differences in performance,
 suggesting robustness to hyperparameter selection for all methods.
\end_layout

\begin_layout Standard
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:comparison"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 compares the cumulative regret of 
\family typewriter
HCSA+TS
\family default
 with other benchmark algorithms across various configurations of 
\begin_inset Formula $d$
\end_inset

 and the number of arms 
\begin_inset Formula $K$
\end_inset

.
 Each line represents the average cumulative regret,
 and the shaded regions indicate the standard deviation across 20 independent trials.
\end_layout

\begin_layout Standard
The results show that 
\family typewriter
HCSA+TS
\family default
 achieves the lowest cumulative regret in all tested settings.
 Compared to 
\family typewriter
LinTS
\family default
,
 
\family typewriter
LinUCB
\family default
,
 and 
\family typewriter
SupLinUCB
\family default
,
 which do not leverage information from all arms,
 
\family typewriter
HCSA+TS
\family default
 demonstrates robustness to missing context data.
 When compared to 
\family typewriter
DRTS
\family default
 and 
\family typewriter
HyRan
\family default
,
 which uses the original context vectors,
 
\family typewriter
HCSA+TS
\family default
 consistently identifies low-regret arms more effectively,
 even under significant masking of context features.
\end_layout

\begin_layout Standard
Initially,
 due to the orthogonal basis regularization,
 
\family typewriter
HCSA+TS
\family default
 incurs higher regret during the exploration phase,
 particularly when the effective rank of the context matrix is low.
 However,
 it rapidly adapts and identifies the optimal arm,
 ultimately outperforming the other algorithms,
 which continue to suffer regret due to their inability to handle missing context data effectively.
\end_layout

\begin_layout Standard
Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:prediction"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 illustrates the prediction error across all arms,
 measured as 
\begin_inset Formula $\sum_{i=1}^{K}\{X_{i,t}^{\top}(\widehat{\theta}_{t}-\theta_{\star})\}^{2}$
\end_inset

.
 Similar to the regret results,
 the averages and standard deviations are computed over 20 trials.
 The initial convergence of the estimators in 
\family typewriter
DRTS
\family default
 and 
\family typewriter
HyRan
\family default
 is faster due to their reliance on imputed contexts.
 However,
 their prediction errors increase over time because the imputed contexts,
 often containing many zero entries,
 provide incomplete information and hinder accurate estimation.
 In contrast,
 
\family typewriter
HCSA+TS
\family default
 demonstrates steady and consistent convergence throughout the experimental horizon.
 Its orthogonal augmentation strategy allows it to extract useful information even when parts of the context vectors are masked,
 leading to superior prediction accuracy compared to both traditional ridge-based estimators (
\family typewriter
LinTS
\family default
,
 
\family typewriter
LinUCB
\family default
,
 
\family typewriter
SupLinUCB
\family default
) and other augmented methods (
\family typewriter
DRTS
\family default
,
 
\family typewriter
HyRan
\family default
).
\end_layout

\begin_layout Standard
The experiments validate that 
\family typewriter
HCSA+TS
\family default
 achieves significant improvements in both cumulative regret and prediction accuracy over existing benchmarks.
 This shows the efficacy of the generalization and convergence on rewards for all arms of the proposed HCSA estimator due to the adaptive augmentation with carefully constructed hypothetical contexts and rewards.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

% 7.
 Conclusion
\end_layout

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Conclusion
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:conclusion"

\end_inset

 This work introduces novel resampling and coupling techniques for integrating adaptive data augmentation into linear contextual bandits (LinCB),
 achieving a nearly minimax-optimal regret bound without imposing structural assumptions on the context vectors.
 By leveraging these techniques,
 the proposed approach enables the algorithm to effectively utilize contextual information from all arms as if full reward feedback were available in each round,
 while minimizing the number of required augmentations.
 Beyond improving regret performance,
 this methodology marks a conceptual advancement in reward estimation.
 Through the use of hypothetical contexts and coupling-based resampling,
 we show that accurate estimation for rewards of all arms is feasible even under arbitrary context distributions,
 thereby broadening the applicability of LinCB methods in non-IID and adversarial settings.
\end_layout

\begin_layout Standard
The proposed framework offers a foundation for extending adaptive augmentation techniques to more general bandit models and reinforcement learning environments.
 In particular,
 these ideas have the potential to reduce variance in reward estimates for optimal arms or general policies,
 thus enabling more efficient exploration and decision-making in complex and high-dimensional settings.
 Future work may explore such extensions,
 including applications to nonlinear bandits,
 structured decision-making problems,
 and policy optimization in reinforcement learning,
 further amplifying the impact of the techniques developed in this study.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%------------------------------------
\end_layout

\begin_layout Plain Layout

% Acknowledgements
\end_layout

\begin_layout Plain Layout

%------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
acks
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

This work was supported by the Institute of Information & Communications Technology Planning & Evaluation (IITP) grant funded by the Korea government (MSIT) [RS-2021-II211341,
 Artificial Intelligence Graduate School Program (Chung-Ang University) and the Chung-Ang University Research Grants in 2025.
 Wonyoung Kim also appreciates the proofreading and advising provided by Myunghee Cho Paik.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

% Appendix
\end_layout

\begin_layout Plain Layout

%-------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\start_of_appendix
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%dummy comment inserted by tex2lyx to ensure that this paragraph is not empty
\end_layout

\end_inset


\end_layout

\begin_layout Section
Missing Proofs
\end_layout

\begin_layout Subsection
Proof of Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:error_decomposition"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:error_decomposition_proof"

\end_inset

 
\end_layout

\begin_layout Proof
Recall that 
\begin_inset Formula 
\begin{align*}
\Gb_{t} & :=\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}Z_{i,s}Z_{i,s}^{\top},\\
A_{t} & :=\sum_{s=1}^{t}\frac{1}{\phi_{\tilde{a}_{s},s}}Z_{\tilde{a}_{s},s}Z_{\tilde{a}_{s},s}^{\top}=\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}Z_{i,s}Z_{i,s}^{\top}.
\end{align*}

\end_inset

By definition of the estimator,
 
\begin_inset Formula 
\[
\begin{split} & \norm{\tilde{\theta}_{t}^{H(\check{\theta}_{t})}-\theta_{\star}}_{\Gb_{t}}\\
 & =\norm{\sum_{s=1}^{t}\sum_{i=1}^{r_{s}+1}\left(\tilde{W}_{i,s}^{H(\check{\theta}_{t})}-Z_{i,s}^{\top}\theta_{\star}\right)Z_{i,s}}_{\Gb_{t}^{-1}}\\
 & =\norm{\sum_{s=1}^{t}\sum_{i=1}^{r_{s}+1}\left\{ 1-\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}\right\} Z_{i,s}Z_{i,s}^{\top}(\check{\theta}_{t}-\theta_{\star})+\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}\left(W_{i,s}-Z_{i,s}^{\top}\theta_{\star}\right)Z_{i,s}}_{\Gb_{t}^{-1}}\\
 & =\norm{(\Gb_{t}-A_{t})(\check{\theta}_{t}-\theta_{\star})+\sum_{s=1}^{t}\sum_{i=1}^{r_{s}+1}\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}\left(W_{i,s}-Z_{i,s}^{\top}\theta_{\star}\right)Z_{i,s}}_{\Gb_{t}^{-1}},
\end{split}
\]

\end_inset

where the second equality holds by the definition
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:HDRY"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 Recall that 
\begin_inset Formula 
\[
\]

\end_inset

Then,
 by the triangle inequality,
 we have 
\begin_inset Formula 
\[
\norm{\tilde{\theta}_{t}^{H(\check{\theta}_{t})}-\theta_{\star}}_{\Gb_{t}}\le\norm{(\Gb_{t}-A_{t})(\check{\theta}_{t}-\theta_{\star})}_{\Gb_{t}^{-1}}+\norm{\sum_{s=1}^{t}\sum_{i=1}^{r_{s}+1}\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}\left(W_{i,s}-Z_{i,s}^{\top}\theta_{\star}\right)Z_{i,s}.}_{\Gb_{t}^{-1}}\!\!\!.
\]

\end_inset

Because 
\begin_inset Formula 
\[
\norm{(\Gb_{t}-A_{t})(\check{\theta}_{t}-\theta_{\star})}_{\Gb_{t}^{-1}}=\norm{\Gb_{t}^{-1/2}(\Gb_{t}-A_{t})(\check{\theta}_{t}-\theta_{\star})}_{2},
\]

\end_inset

which completes the proof.
 
\end_layout

\begin_layout Subsection
Proof of Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:self"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:tail_proof"

\end_inset


\end_layout

\begin_layout Proof
By the definition of the proposed estimator and the coupling inequality (Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:coupling"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

),
 for any 
\begin_inset Formula $x>0$
\end_inset

,
 
\begin_inset Formula 
\[
\PP\left(\norm{\widehat{\theta}_{t}-\theta_{\star}}_{\Gb_{t}}>x\right)\le\PP\left(\left\{ \norm{\widehat{\theta}_{t}^{HDR(\check{\theta}_{t})}-\theta_{\star}}_{\Gb_{t}}>x\right\} \cap\Scal_{t}\right)+\delta.
\]

\end_inset

From the error decomposition in Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:error_decomposition"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 for 
\begin_inset Formula $x>0$
\end_inset

,
 
\begin_inset Formula 
\begin{align*}
 & \PP\left(\left\{ \norm{\widehat{\theta}_{t}^{HDR(\check{\theta}_{t})}-\theta_{\star}}_{\Gb_{t}}>x\right\} \cap\Scal_{t}\right)\\
 & \le\PP\left(\left\{ \norm{\Gb_{t}^{-1/2}(A_{t}-\Gb_{t})(\check{\theta}_{t}-\theta_{\star})}_{2}+\norm{S_{t}}_{\Gb_{t}^{-1}}>x\right\} \cap\Scal_{t}\right),
\end{align*}

\end_inset

where 
\begin_inset Formula 
\[
S_{t}:=\sum_{s=1}^{t}\sum_{i=1}^{r_{s}+1}\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}\left(W_{i,s}-Z_{i,s}^{\top}\theta_{\star}\right)Z_{i,s}.
\]

\end_inset

By the definition of 
\begin_inset Formula $\check{\theta}_{t}$
\end_inset

,
 
\begin_inset Formula 
\[
\check{\theta}_{t}-\theta_{\star}:=\left(\sum_{s=1}^{t}X_{a_{s},s}X_{a_{s},s}+\gamma I_{d}\right)^{-1}\left\{ \sum_{s=1}^{t}(Y_{a_{s},s}-X_{a_{s},s}^{\top}\theta_{\star})X_{a_{s},s}-\gamma\theta_{\star}\right\} ,
\]

\end_inset

and similarly,
 
\begin_inset Formula 
\[
\check{\theta}_{t}-\theta_{\star}=\left(A_{t}+I_{d}\right)^{-1}\left(S_{t}-\theta_{\star}\right).
\]

\end_inset

Substituting into the error bound,
 we have 
\begin_inset Formula 
\[
\begin{split}\norm{\widehat{\theta}_{t}-\theta_{\star}}_{\Gb_{t}} & \le\norm{(\Gb_{t}-A_{t})(A_{t}+I_{d})^{-1}(S_{t}-\theta_{\star})}_{\Gb_{t}^{-1}}+\norm{S_{t}}_{\Gb_{t}^{-1}}\\
 & =\norm{\Gb_{t}^{-1/2}(\Gb_{t}-A_{t})(A_{t}+I_{d})^{-1}(S_{t}-\theta_{\star})}_{2}+\norm{S_{t}}_{\Gb_{t}^{-1}},
\end{split}
\]

\end_inset

where the last equality holds by the definition of 
\begin_inset Formula $\|\cdot\|_{\Gb_{t}^{-1}}$
\end_inset

.
 By the definition of the spectral norm 
\begin_inset Formula $\|\cdot\|_{2}$
\end_inset

,
 
\begin_inset Formula 
\begin{align*}
 & \norm{\Gb_{t}^{-1/2}(\Gb_{t}-A_{t})(A_{t}+I_{d})^{-1}(S_{t}-\theta_{\star})}_{2}\\
 & \le\bigg\Vert\underset{P_{t}}{\underbrace{\Gb_{t}^{-1/2}(\Gb_{t}-A_{t})(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}}}\bigg\Vert_{2}\norm{S_{t}-\theta_{\star}}_{\Gb_{t}^{-1}}.
\end{align*}

\end_inset

Thus,
 the bound becomes 
\begin_inset Formula 
\[
\norm{\widehat{\theta}_{t}-\theta_{\star}}_{\Gb_{t}}\le\big(\norm{P_{t}}_{2}+1\big)\norm{S_{t}}_{\Gb_{t}^{-1}}+\norm{P_{t}}_{2}\theta_{\max}\lambda_{\min}(\Gb_{t})^{-1/2}.
\]

\end_inset

By the property of 
\begin_inset Formula $\Gb_{t}$
\end_inset

 (Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:Gram"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) 
\begin_inset Formula $\lambda_{\min}(\Gb_{t})\ge\max\{x_{\max}^{2},1\}h_{t}\ge1$
\end_inset

.
 It follows that 
\begin_inset Formula 
\[
\norm{\widehat{\theta}_{t}-\theta_{\star}}_{\Gb_{t}}\le\big(\norm{P_{t}}_{2}+1\big)\norm{S_{t}}_{\Gb_{t}^{-1}}+\norm{P_{t}}_{2}\theta_{\max}.
\]

\end_inset

Thus,
 
\begin_inset Formula 
\[
\begin{split} & \PP\left(\bigcap_{t:|\Acal_{t}|\ge h_{t}}\left[\left\{ \norm{\widehat{\theta}_{t}-\theta_{\star}}_{\Gb_{t}}>x\right\} \cap\Scal_{t}\right]\right)\\
 & \le\PP\left(\bigcap_{t:|\Acal_{t}|\ge h_{t}}\left[\left\{ \big(\norm{P_{t}}_{2}+1\big)\norm{S_{t}}_{\Gb_{t}^{-1}}+\norm{P_{t}}_{2}\theta_{\max}>x\right\} \cap\Scal_{t}\right]\right)+\delta.
\end{split}
\]

\end_inset

By Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:P_t_bound"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 we have 
\begin_inset Formula $\PP(\|P_{t}\|_{2}>5)\le\delta/t^{2}$
\end_inset

 for all 
\begin_inset Formula $t$
\end_inset

 such that 
\begin_inset Formula $|\Acal_{t}|\ge h_{t}$
\end_inset

.
 Thus,
 
\begin_inset Formula 
\begin{align*}
 & \PP\left(\bigcap_{t:|\Acal_{t}|\ge h_{t}}\left[\left\{ \big(\norm{P_{t}}_{2}+1\big)\norm{S_{t}}_{\Gb_{t}^{-1}}+\norm{P_{t}}_{2}\theta_{\max}>x\right\} \cap\Scal_{t}\right]\right)+\delta\\
 & \le\PP\bigg(\bigcap_{t:|\Acal_{t}|\ge h_{t}}\left[\left\{ 21\norm{S_{t}}_{\Gb_{t}^{-1}}+20\theta_{\max}>x\right\} \cap\Scal_{t}\right]\bigg)+\PP\Big(\cup_{t:|\Acal_{t}|\ge h_{t}}\big\{\|P_{t}\|>20\big\}\Big)+\delta\\
 & \le\PP\bigg(\bigcap_{t:|\Acal_{t}|\ge h_{t}}\left[\left\{ \norm{S_{t}}_{\Gb_{t}^{-1}}>\frac{x}{21}-\frac{20}{21}\theta_{\max}\right\} \cap\Scal_{t}\right]\bigg)+2\delta.
\end{align*}

\end_inset

By Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:S_t_bound"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 setting 
\begin_inset Formula $x=20\theta_{\max}+\frac{21\sigma}{\gamma}\sqrt{d\log\frac{1+t}{\delta}}$
\end_inset

 completes the proof of the theorem.
 
\end_layout

\begin_layout Subsection
Probability Bounds for the Norms
\end_layout

\begin_layout Standard
This section provides the probability inequalities for the norms of the core terms:
 
\begin_inset Formula $P_{t}$
\end_inset

 and 
\begin_inset Formula $S_{t}$
\end_inset

.
 These bounds are key to proving the convergence of the estimator.
 We will use tail inequalities for random matrices and sums to obtain the desired results.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{lemma}
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "lem:P_t_bound"

\end_inset

 Suppose 
\begin_inset Formula $t\ge T_{1}$
\end_inset

.
 Then,
 with probability at least 
\begin_inset Formula $1-\frac{\delta}{t^{2}}$
\end_inset

,
 the spectral norm 
\begin_inset Formula $\|P_{t}\|_{2}\le5$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{lemma}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
By the definition of 
\begin_inset Formula $P_{t}$
\end_inset

,
 we have 
\begin_inset Formula 
\[
\|P_{t}\|_{2}=\|\Gb_{t}^{-1/2}(\Gb_{t}-A_{t})(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}\|_{2}.
\]

\end_inset

Expanding this,
 
\begin_inset Formula 
\[
\|P_{t}\|_{2}=\|\Gb_{t}^{1/2}(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}-\Gb_{t}^{-1/2}A_{t}(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}\|_{2}.
\]

\end_inset

Next,
 we simplify further:
 
\begin_inset Formula 
\[
\|P_{t}\|_{2}=\|\Gb_{t}^{1/2}(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}-I_{d}+\Gb_{t}^{-1/2}(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}\|_{2}.
\]

\end_inset

This gives us the bound:
 
\begin_inset Formula 
\[
\|P_{t}\|_{2}\le\|\Gb_{t}^{1/2}(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}-I_{d}\|_{2}+\|\Gb_{t}^{-1/2}(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}\|_{2}.
\]

\end_inset

Since 
\begin_inset Formula $\Gb_{t}$
\end_inset

 and 
\begin_inset Formula $A_{t}$
\end_inset

 are real symmetric and positive semidefinite,
 we have the following:
 
\begin_inset Formula 
\[
\|\Gb_{t}^{1/2}(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}\|_{2}\le\frac{1}{\lambda_{\min}(\Gb_{t})}\|\Gb_{t}^{1/2}(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}\|_{2}.
\]

\end_inset

Thus,
 we obtain:
 
\begin_inset Formula 
\[
\|P_{t}\|_{2}\le\|\Gb_{t}^{1/2}(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}-I_{d}\|_{2}+\frac{1}{\lambda_{\min}(\Gb_{t})}\|\Gb_{t}^{1/2}(A_{t}+I_{d})^{-1}\Gb_{t}^{1/2}\|_{2}.
\]

\end_inset

Let 
\begin_inset Formula 
\[
\Fb_{t}:=\bar{x}_{\max}^{2}\Big(\sum_{s\in[t]\setminus\Acal_{t}}\sum_{i=1}^{r_{s}}u_{i,s}u_{i,s}^{\top}+\sum_{s\in[t]\setminus\Acal_{t}}\sum_{i=1}^{d}u_{i,s}u_{i,s}^{\top}\Big).
\]

\end_inset

By the equivalence lemmas (Lemma ??
 and Lemma ??) 
\begin_inset Formula $\Gb_{t}\preceq5\Fb_{t}$
\end_inset

.
 Note that 
\begin_inset Formula $\Fb_{t}$
\end_inset

 does not depend on both 
\begin_inset Formula $a_{t}$
\end_inset

 and 
\begin_inset Formula $\tilde{a}_{t}$
\end_inset

.
 Thus the matrix,
 
\begin_inset Formula 
\[
\Gb_{t}^{-1/2}(A_{t}+I_{d})\Gb_{t}^{-1/2}\succeq\frac{1}{5}\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}\Fb_{t}^{-1/2}Z_{i,s}Z_{i,s}^{\top}\Fb_{t}^{-1/2}
\]

\end_inset

Let 
\begin_inset Formula $\Fcal_{t}$
\end_inset

 denote the sigma-algebra generated by 
\begin_inset Formula $\big\{(X_{k,s},a_{s},\tilde{a}_{s}):k\in[K],s\in[t]\big\}$
\end_inset

 and 
\begin_inset Formula $\big\{(a_{s},\tilde{a}_{s}):s\in[t]\big\}\cup\{a_{t+1}\}$
\end_inset

.
 Because the distribution of the hypothetical action 
\begin_inset Formula $\tilde{a}_{t}$
\end_inset

 is 
\begin_inset Formula $\tilde{\pi}_{t}$
\end_inset

 given 
\begin_inset Formula $a_{t}$
\end_inset

 and 
\begin_inset Formula $\Fb_{t}$
\end_inset

 depends only on the original contexts 
\begin_inset Formula $\{X_{k,s}:k\in[K],s\in[t]\}$
\end_inset

,
 
\begin_inset Formula 
\begin{align*}
 & \EE\Big[\sum_{i=1}^{N_{s}}\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}\Fb_{t}^{-1/2}Z_{i,s}Z_{i,s}^{\top}\Fb_{t}^{-1/2}\Big|\Fcal_{t-1}\Big]\\
 & =\Fb_{t}^{-1/2}\CE{\sum_{i=1}^{N_{s}}\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}}{\Fcal_{t-1}}Z_{i,s}Z_{i,s}^{\top}\Fb_{t}^{-1/2}\\
 & =\sum_{i=1}^{N_{s}}\Fb_{t}^{-1/2}Z_{i,s}Z_{i,s}^{\top}\Fb_{t}^{-1/2},
\end{align*}

\end_inset

where the first equality holds because hypothetical contexts 
\begin_inset Formula $\{Z_{i,s}:i\in[N_{s}]\}$
\end_inset

 is deterministic given the original contexts 
\begin_inset Formula $\{X_{k,t}:k\in[K]\}$
\end_inset

 and the action 
\begin_inset Formula $a_{t}$
\end_inset

.
 Observe that for each 
\begin_inset Formula $s\in[t]$
\end_inset

,
 
\begin_inset Formula 
\begin{align*}
 & \lambda_{\max}\Big(\sum_{i=1}^{N_{s}}\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}\Fb_{t}^{-1/2}Z_{i,s}Z_{i,s}^{\top}\Fb_{t}^{-1/2}\Big)\\
 & \le\frac{d}{1-\gamma}\max_{i\in[N_{s}]}\lambda_{\max}(\Fb_{t}^{-1/2}Z_{i,s}Z_{i,s}^{\top}\Fb_{t}^{-1/2})\\
 & =\frac{d}{1-\gamma}\max_{i\in[N_{s}]}\|Z_{i,s}\|_{\Fb_{t}^{-1}}^{2}.
\end{align*}

\end_inset

By definition of the hypothetical contexts 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:new_contexts"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 for any 
\begin_inset Formula $s\in[t]$
\end_inset

 and 
\begin_inset Formula $i\in[N_{s}]$
\end_inset

,
 
\begin_inset Formula 
\begin{align*}
\Fb_{t} & \succeq2\bar{x}_{\max}^{2}h_{t}I_{d}\\
 & \succeq Z_{i,s}Z_{i,s}^{\top}+\bar{x}_{\max}^{2}h_{t}I_{d},
\end{align*}

\end_inset

where the last inequality uses 
\begin_inset Formula $\|Z_{i,s}\|_{2}\le\max\{x_{\max},1\}$
\end_inset

.
 Using Sherman-Morrison formula,
 for any 
\begin_inset Formula $s\in[t]$
\end_inset

 and 
\begin_inset Formula $i\in[N_{s}]$
\end_inset

,
 
\begin_inset Formula 
\begin{align*}
\|Z_{i,s}\|_{\Fb_{t}^{-1}}^{2} & \le Z_{i,s}^{\top}\big(Z_{i,s}Z_{i,s}^{\top}+\bar{x}_{\max}^{2}h_{t}I_{d}\big)^{-1}Z_{i,s}\\
 & \le\frac{\|Z_{i,s}\|_{2}^{2}}{\bar{x}_{\max}^{2}h_{t}+\|Z_{i,s}\|_{2}^{2}}\\
 & \le\frac{1}{h_{t}+1},
\end{align*}

\end_inset

where the last inequality uses 
\begin_inset Formula $\|Z_{i,s}\|_{2}\le\bar{x}_{\max}$
\end_inset

.
 By definition of 
\begin_inset Formula $h_{t}$
\end_inset

,
 we obtain,
 
\begin_inset Formula 
\[
\lambda_{\max}\Big(\sum_{i=1}^{N_{s}}\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}\Fb_{t}^{-1/2}Z_{i,s}Z_{i,s}^{\top}\Fb_{t}^{-1/2}\Big)\le\frac{d}{(1-\gamma)h_{t}}\le\frac{1/2-e^{-1}}{2}\big(\log\frac{dt^{2}}{\delta}\big)^{-1}
\]

\end_inset

Then by Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:matrix_neg"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 with probability at least 
\begin_inset Formula $1-\delta/t^{2}$
\end_inset

 
\begin_inset Formula 
\begin{align*}
 & 2(1/2-e^{-1})^{-1}\log\frac{dt^{2}}{\delta}\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}\Fb_{t}^{-1/2}Z_{i,s}Z_{i,s}^{\top}\Fb_{t}^{-1/2}\\
 & \succeq2(1/2-e^{-1})^{-1}\log\frac{dt^{2}}{\delta}(1-e^{-1})\Fb_{t}^{-1}\Gb_{t}\Fb_{t}^{-1}-\log\frac{dt^{2}}{\delta}I_{d}\\
 & \succeq(1/2-e^{-1})^{-1}\log\frac{dt^{2}}{\delta}(1-e^{-1})I_{d}-\log\frac{dt^{2}}{\delta}I_{d},
\end{align*}

\end_inset

where the last inequality uses the fact that 
\begin_inset Formula $\Gb_{t}\succeq\Fb_{t}/2$
\end_inset

 (Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:Gram"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
 Thus,
 
\begin_inset Formula 
\[
\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}\frac{\II(\tilde{a}_{s}=i)}{\phi_{i,s}}\Fb_{t}^{-1/2}Z_{i,s}Z_{i,s}^{\top}\Fb_{t}^{-1/2}\succeq\frac{1-e^{-1}}{2}-\frac{1/2-e^{-1}}{2}=\frac{1}{4},
\]

\end_inset

which implies,
 
\begin_inset Formula 
\[
\Gb_{t}^{-1}(A_{t}+I_{d})\Gb_{t}^{-1}\succeq\frac{1}{20}I_{d}.
\]

\end_inset

Thus,
 
\begin_inset Formula 
\[
\|\Gb_{t}(A_{t}+I_{d})\Gb_{t}\|_{2}\le20,
\]

\end_inset

which implies 
\begin_inset Formula 
\[
\|P_{t}\|_{2}\le20-1+\frac{20}{\lambda_{\min}(\Gb_{t})}.
\]

\end_inset

Since 
\begin_inset Formula ${\min}(\Gb_{t})\ge h_{t}\max\{x_{\max}^{2},1\}\ge20$
\end_inset

,
 we have 
\begin_inset Formula 
\[
\|P_{t}\|_{2}\le20
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{lemma}
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "lem:S_t_bound"

\end_inset

 For any 
\begin_inset Formula $\delta\in(0,1)$
\end_inset

,
 
\begin_inset Formula 
\[
\mathbb{P}\left(\bigcap_{t:|\Acal_{t}|\ge h_{t}}\left[\left\{ \|S_{t}\|_{\Gb_{t}}>\frac{\sigma}{\gamma}\sqrt{d\log\frac{1+t}{\delta}}\right\} \cap\Scal_{t}\right]\right)\le\delta.
\]

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{lemma}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
Under the event 
\begin_inset Formula $\Scal_{t}$
\end_inset

,
 we have:
 
\begin_inset Formula 
\[
\|S_{t}\|_{\Gb_{t}^{-1}}:=\left\Vert \sum_{s=1}^{t}\sum_{i=1}^{r_{s}+1}\frac{\mathbb{I}(\tilde{a}_{s}=i)}{\phi_{i,s}}\left(W_{i,s}-Z_{i,s}^{\top}\theta_{\star}\right)Z_{i,s}\right\Vert _{\Gb_{t}^{-1}}.
\]

\end_inset

Simplifying this,
 we get:
 
\begin_inset Formula 
\[
\|S_{t}\|_{\Gb_{t}^{-1}}=\frac{1}{\gamma}\left\Vert \sum_{s=1}^{t}\eta_{a_{s},s}X_{a_{s},s}\right\Vert _{\Gb_{t}^{-1}}.
\]

\end_inset

Next,
 we observe that the Gram matrix 
\begin_inset Formula $\Gb_{t}$
\end_inset

 satisfies:
 
\begin_inset Formula 
\[
\Gb_{t}\succeq\sum_{s=1}^{t}X_{a_{s},s}X_{a_{s},s}^{\top}+\sum_{s\in\Acal_{t}}\sum_{i=1}^{d}Z_{i,s}Z_{i,s}^{\top}.
\]

\end_inset

By the definition of the new contexts,
 we have:
 
\begin_inset Formula 
\[
\sum_{s\in\Acal_{t}}\sum_{i=1}^{d}Z_{i,s}Z_{i,s}^{\top}\succeq h_{t}\max\{x_{\max}^{2},1\}I_{d}.
\]

\end_inset

Thus,
 
\begin_inset Formula 
\[
\Gb_{t}\succeq\sum_{s=1}^{t}X_{a_{s},s}X_{a_{s},s}^{\top}+\max\{x_{\max}^{2},1\}I_{d}.
\]

\end_inset

Using Lemma 9 and Lemma 10 from 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{abbasi2011improved}
\end_layout

\end_inset

,
 with probability at least 
\begin_inset Formula $1-\delta$
\end_inset

,
 we get:
 
\begin_inset Formula 
\[
\frac{1}{\gamma}\left\Vert \sum_{s=1}^{t}\eta_{a_{s},s}X_{a_{s},s}\right\Vert _{\Gb_{t}}\le\frac{\sigma}{\gamma}\sqrt{d\log\left(\frac{1+t}{\delta}\right)}.
\]

\end_inset

This completes the proof.
 
\end_layout

\begin_layout Subsection
Proof of Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:super_unsaturated_arms"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:low_regret_proof"

\end_inset

 
\end_layout

\begin_layout Proof
For 
\begin_inset Formula $k\in[K]$
\end_inset

 and 
\begin_inset Formula $t\in[T]$
\end_inset

,
 let 
\begin_inset Formula $\tilde{Y}_{k,t}:=X_{k,t}^{\top}\tilde{\theta}_{k,t}$
\end_inset

 denote the estimated reward for arm 
\begin_inset Formula $k$
\end_inset

.
 Define the maximizer 
\begin_inset Formula $\tilde{M}_{t}:=\arg\max_{k\in[K]}\tilde{Y}_{k,t}$
\end_inset

.
 Since 
\family typewriter
HCSA+TS
\family default
 selects the arm that maximizes 
\begin_inset Formula $\tilde{Y}_{k,t}$
\end_inset

,
 the distribution of 
\begin_inset Formula $a_{t}$
\end_inset

 matches that of 
\begin_inset Formula $\tilde{M}_{t}$
\end_inset

,
 i.e.,
 
\begin_inset Formula 
\[
\CP{a_{t}\in\Pcal_{t}}{\Hcal_{t}}=\CP{\tilde{M}_{t}\in\Pcal_{t}}{\Hcal_{t}}.
\]

\end_inset

Suppose the estimated reward for the optimal arm,
 
\begin_inset Formula $\tilde{Y}_{a_{t}^{\star},t}$
\end_inset

,
 exceeds 
\begin_inset Formula $\tilde{Y}_{j,t}$
\end_inset

 for all 
\begin_inset Formula $j\in[K]\setminus\Pcal_{t}$
\end_inset

.
 Since the optimal arm 
\begin_inset Formula $a_{t}^{\star}$
\end_inset

 is always in 
\begin_inset Formula $\Pcal_{t}$
\end_inset

 by definition,
 it follows that 
\begin_inset Formula $a_{t}^{\star}\in\Pcal_{t}$
\end_inset

.
 Thus:
 
\begin_inset Formula 
\[
\CP{\tilde{M}_{t}\in\Pcal_{t}}{\Hcal_{t}}\ge\CP{\bigcap_{j\in[K]\setminus\Pcal_{t}}\{\tilde{Y}_{j,t}<\tilde{Y}_{a_{t}^{\star},t}\}}{\Hcal_{t}}.
\]

\end_inset

Let 
\begin_inset Formula $Z_{j,t}:=\tilde{Y}_{a_{t}^{\star},t}-\tilde{Y}_{j,t}-(X_{a_{t}^{\star},t}-X_{j,t})^{\top}\Estimator{t-1}$
\end_inset

.
 Then:
 
\begin_inset Formula 
\[
\CP{\tilde{M}_{t}\in\Pcal_{t}}{\Hcal_{t}}\ge\CP{\bigcap_{j\in[K]\setminus\Pcal_{t}}\{Z_{j,t}>(X_{j,t}-X_{a_{t}^{\star},t})^{\top}\Estimator{t-1}\}}{\Hcal_{t}}.
\]

\end_inset

Given 
\begin_inset Formula $\Hcal_{t}$
\end_inset

,
 
\begin_inset Formula $\{Z_{j,t}:j\in[K]\setminus\Pcal_{t}\}$
\end_inset

 are Gaussian random variables with mean 0 and variance 
\begin_inset Formula $\Gb_{t}(\|X_{a_{t}^{\star},t}\|_{V_{t-1}^{-1}}^{2}+\|X_{j,t}\|_{V_{t-1}^{-1}}^{2})$
\end_inset

.
 For each 
\begin_inset Formula $j\notin\Pcal_{t}$
\end_inset

,
 we have:
 
\begin_inset Formula 
\[
(X_{j,t}-X_{a_{t}^{\star},t})^{\top}\Estimator{t-1}\le2x_{t}\norm{\Estimator{t-1}-\theta_{\star}}_{V_{t-1}}-\Diff{j}{t}\le-\sqrt{\norm{X_{a_{t}^{\star},t}}_{V_{t-1}^{-1}}^{2}+\norm{X_{j,t}}_{V_{t-1}^{-1}}^{2}}.
\]

\end_inset

Thus:
 
\begin_inset Formula 
\[
\CP{\tilde{M}_{t}\in\Pcal_{t}}{\Hcal_{t}}\ge\CP{\frac{Z_{j,t}}{\Gb_{t}\sqrt{\norm{X_{a_{t}^{\star},t}}_{V_{t-1}^{-1}}^{2}+\norm{X_{j,t}}_{V_{t-1}^{-1}}^{2}}}>-\frac{1}{\Gb_{t}},\forall j\notin\Pcal_{t}}{\Hcal_{t}}.
\]

\end_inset

Since 
\begin_inset Formula $Z_{j,t}$
\end_inset

 is Gaussian with variance normalized to 1,
 
\begin_inset Formula 
\[
\begin{split}\CP{\tilde{M}_{t}\in\Pcal_{t}}{\Hcal_{t}}\ge & \CP{\frac{Z_{j,t}}{\Gb_{t}\sqrt{\norm{X_{a_{t}^{\star},t}}_{V_{t-1}^{-1}}^{2}+\norm{X_{j,t}}_{V_{t-1}^{-1}}^{2}}}>-\frac{1}{\Gb_{t}},\forall j\notin\Pcal_{t}}{\Hcal_{t}}\\
:= & \CP{Y_{j}>-\Gb_{t},\forall j\neq\Pcal_{t}}{\Hcal_{t}},
\end{split}
\]

\end_inset

where 
\begin_inset Formula 
\[
Y_{j}:=\frac{Z_{j,t}}{\Gb_{t}\sqrt{\norm{X_{a_{t}^{\star},t}}_{V_{t-1}^{-1}}^{2}+\norm{X_{j,t}}_{V_{t-1}^{-1}}^{2}}}
\]

\end_inset

is a standard Gaussian random variable given 
\begin_inset Formula $\Hcal_{t}$
\end_inset

.
 Therefore,
 we have:
 
\begin_inset Formula 
\[
\CP{Y_{j}\le-\Gb_{t}}{\Hcal_{t}}\le\exp\left(-\frac{1}{2\Gb_{t}}\right).
\]

\end_inset

Now,
 setting 
\begin_inset Formula $\Gb_{t}=\left(2\log\frac{K(t+1)^{2}}{\delta}\right)^{-1/2}$
\end_inset

,
 we get:
 
\begin_inset Formula 
\[
\CP{Y_{j}\le-\Gb_{t}}{\Hcal_{t}}\le\exp\left(-\log\frac{(t+1)^{2}}{\delta}\right)=\frac{\delta}{K(t+1)^{2}}.
\]

\end_inset

Thus,
 we obtain:
 
\begin_inset Formula 
\[
\begin{aligned}\CP{\tilde{M}_{t}\in\Pcal_{t}}{\Hcal_{t}}\ge & \ 1-\CP{Y_{j}\le-\Gb_{t},\exists j\notin\Pcal_{t}}{\Hcal_{t}}\\
\ge & \ 1-\sum_{j\notin\Pcal_{t}}\CP{Y_{j}\le-\Gb_{t}}{\Hcal_{t}}\\
\ge & \ 1-\frac{\delta}{(t+1)^{2}}.
\end{aligned}
\]

\end_inset

This completes the proof.
 
\end_layout

\begin_layout Subsection
Proof of Lemma
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "lem:elliptical"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:proof_elliptical"

\end_inset

 
\end_layout

\begin_layout Proof
By definition of 
\begin_inset Formula $\Acal_{t}$
\end_inset

,
 for 
\begin_inset Formula $t$
\end_inset

 such that 
\begin_inset Formula $t\le h_{t}$
\end_inset

,
 we have 
\begin_inset Formula $t\in\Acal_{t}$
\end_inset

 and 
\begin_inset Formula $1\in\Acal_{t}$
\end_inset

 for all 
\begin_inset Formula $t\in[T]$
\end_inset

.
 By definition of the new contexts
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:new_contexts"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 for any 
\begin_inset Formula $t\in[T]$
\end_inset

,
 
\begin_inset Formula 
\begin{align*}
\Gb_{t}=\sum_{s=1}^{t}\sum_{i=1}^{N_{s}}Z_{i,t}Z_{i,t}^{\top} & \succeq\sum_{s\in[t]\setminus\Acal_{t}}\sum_{i=1}^{N_{s}}Z_{i,s}Z_{i,s}^{\top}+\sum_{i=1}^{d}u_{i,1}u_{i,1}^{\top}\\
 & \succeq\sum_{s\in[t]\setminus\Acal_{t}}\sum_{i=1}^{N_{s}}Z_{i,s}Z_{i,s}^{\top}+\bar{x}_{\max}^{2}\Ib_{d}.
\end{align*}

\end_inset

For 
\begin_inset Formula $t\in[T]\setminus\Acal_{T}$
\end_inset

,
 define 
\begin_inset Formula 
\[
\nu_{t}:=\underset{a\in[K]}{\text{argmax}}\|X_{a,t}\|_{(\sum_{s\in[t-1]\setminus\Acal_{t}}X_{\nu_{s},s}X_{\nu_{s},s}^{\top}+\bar{x}_{\max}^{2}\Ib_{d})^{-1}}
\]

\end_inset

By Lemma ??,
 
\begin_inset Formula 
\[
\Gb_{t}\succeq\frac{1}{2}\underset{W_{t}}{\underbrace{\sum_{s\in[t]\setminus\Acal_{t}}X_{\nu_{s},s}X_{\nu_{s},s}^{\top}+\bar{x}_{\max}^{2}\Ib_{d}.}}
\]

\end_inset

and 
\begin_inset Formula $x_{t}^{2}\leq2\|X_{\nu_{t},t}\|_{W_{t-1}^{-1}}^{2}$
\end_inset

.
 Applying Lemma 11 from 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{abbasi2011improved}
\end_layout

\end_inset

:
 
\begin_inset Formula 
\[
\sum_{t\in[T]\setminus\Acal_{T}}x_{t}^{2}\leq2\sum_{t\in[T]\setminus\Acal_{T}}\|X_{\nu_{t},t}\|_{W_{t-1}^{-1}}^{2}\leq4\log\frac{\det(W_{T})}{\det(\max\{x_{\max}^{2},1\}I_{d})}.
\]

\end_inset

By AM-GM inequality,
 
\begin_inset Formula $\det(W_{T})\leq\left(\frac{\Trace{W_{T}}}{d}\right)^{d}\leq\left(\frac{T\max\{x_{\max}^{2},1\}}{d}\right)^{d}$
\end_inset

 holds.
 Thus,
 
\begin_inset Formula 
\[
\sum_{t\in[T]\setminus\Acal_{T}}x_{t}^{2}\leq4d\log\frac{\Trace{W_{T}}}{\max\{x_{\max}^{2},1\}d}\leq4d\log\frac{T\max\{x_{\max}^{2},1\}}{\max\{x_{\max}^{2},1\}d}\leq4d\log\frac{T}{d},
\]

\end_inset

which completes the proof.
 
\end_layout

\begin_layout Section
Technical Results
\end_layout

\begin_layout Subsection
Threshold for logarithmic inequality.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{proposition}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

Threshold for logarithmic inequality Lemma C.6 in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{kim2025learning}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "prop:logt"

\end_inset

 For 
\begin_inset Formula $a>1/2$
\end_inset

 and 
\begin_inset Formula $b>e^{2}$
\end_inset

,
 
\begin_inset Formula $t\ge4a\left(1+\log\frac{2a\sqrt{b}}{e}\right)$
\end_inset

 implies 
\begin_inset Formula $t\ge a\log bt^{2}$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{proposition}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
A Matrix Concentration Inequality
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{lemma}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

[
\end_layout

\end_inset

Matrix concentration inequality
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

]
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "lem:matrix_neg"

\end_inset

 Let 
\begin_inset Formula $\{M_{s}:s\in[t]\}$
\end_inset

 be a 
\begin_inset Formula $\RR^{d\times d}$
\end_inset

-valued stochastic process adapted to the filtration 
\begin_inset Formula $\{\Fcal_{s}:s\in[t]\}$
\end_inset

.
 Suppose 
\begin_inset Formula $M_{s}$
\end_inset

 are nonnegative definite symmetric matrices such that 
\begin_inset Formula $\Maxeigen{M_{s}}\le1$
\end_inset

.
 Then,
 with probability at least 
\begin_inset Formula $1-\delta$
\end_inset

,
 
\begin_inset Formula 
\[
\sum_{s=1}^{t}M_{s}\succeq(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}-\log\frac{d}{\delta}I_{d}.
\]

\end_inset

In addition,
 with probability at least 
\begin_inset Formula $1-\delta$
\end_inset

,
 
\begin_inset Formula 
\[
\sum_{s=1}^{t}M_{s}\preceq\left(e-1\right)\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}+\log\frac{d}{\delta}I_{d}.
\]

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{lemma}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
This proof is an adapted version of the argument from 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citet{tropp2012user}
\end_layout

\end_inset

.
\end_layout

\begin_layout Proof
For the lower bound,
 it is sufficient to prove that 
\begin_inset Formula 
\[
\Maxeigen{-\sum_{s=1}^{t}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}}\le\log\frac{d}{\delta},
\]

\end_inset

with probability at least 
\begin_inset Formula $1-\delta$
\end_inset

.
 By the spectral mapping theorem,
 
\begin_inset Formula 
\begin{align*}
 & \exp\left(\Maxeigen{-\sum_{s=1}^{t}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}}\right)\\
 & \le\Maxeigen{\exp\left(-\sum_{s=1}^{t}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}\right)}\\
 & \le\Trace{\exp\left(-\sum_{s=1}^{t}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}\right)}.
\end{align*}

\end_inset

Taking the expectation of both sides gives:
 
\begin_inset Formula 
\begin{align*}
 & \EE\exp\left(\Maxeigen{-\sum_{s=1}^{t}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}}\right)\\
 & \le\EE\Trace{\exp\left(-\sum_{s=1}^{t}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}\right)}\\
 & =\EE\Trace{\CE{\exp\left(-\sum_{s=1}^{t-1}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}+\log\exp\left(-M_{t}\right)\right)}{\Fcal_{t-1}}}\\
 & \le\EE\Trace{\exp\left(-\sum_{s=1}^{t-1}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}+\log\CE{\exp\left(-M_{t}\right)}{\Fcal_{t-1}}\right)}.
\end{align*}

\end_inset

The last inequality follows from Lieb's theorem 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
citep{tropp2015introduction}
\end_layout

\end_inset

.
 Define a function 
\begin_inset Formula $f_{\lambda}:[0,1]\to\RR$
\end_inset

 as 
\begin_inset Formula $f_{\lambda}(x)=e^{\lambda x}-x(e^{\lambda}-1)-1$
\end_inset

.
 Then 
\begin_inset Formula $f_{\lambda}(x)$
\end_inset

 is convex with 
\begin_inset Formula $f_{\lambda}(0)=f_{\lambda}(1)=0$
\end_inset

 for all 
\begin_inset Formula $\lambda\in\RR$
\end_inset

.
 Thus,
 
\begin_inset Formula $e^{-x}\le1+x(e^{-1}-1)$
\end_inset

 for 
\begin_inset Formula $x\in[0,1]$
\end_inset

.
 Because the eigenvalues of 
\begin_inset Formula $M_{s}$
\end_inset

 lie in 
\begin_inset Formula $[0,1]$
\end_inset

,
 by the spectral mapping theorem,
 we have 
\begin_inset Formula 
\[
\CE{\exp\left(-M_{t}\right)}{\Fcal_{t-1}}\preceq I+(e^{-1}-1)\CE{M_{t}}{\Fcal_{t-1}}\preceq\exp\left(-(1-e^{-1})\CE{M_{t}}{\Fcal_{t-1}}\right).
\]

\end_inset

Thus,
 we obtain:
 
\begin_inset Formula 
\begin{align*}
 & \EE\exp\left(\Maxeigen{-\sum_{s=1}^{t}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}}\right)\\
 & \le\EE\Trace{\exp\left(-\sum_{s=1}^{t-1}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}+\log\exp\left(-M_{t}\right)\right)}\\
 & =\EE\Trace{\exp\Bigl(-\sum_{s=1}^{t-1}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}+\log\exp(-(1-e^{-1})\CE{M_{t}}{\Fcal_{s-1}})\Bigr)}\\
 & =\EE\Trace{\exp\left(-\sum_{\tau=1}^{t-1}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}\right)}\\
 & \le\vdots\\
 & \le\EE\Trace{\exp\left(O\right)}=d.
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
Now,
 by Markov's inequality:
 
\begin_inset Formula 
\begin{align*}
 & \PP\left(\Maxeigen{-\sum_{s=1}^{t}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}}>\log\frac{d}{\delta}\right)\\
 & \le\EE\exp\left(\Maxeigen{-\sum_{s=1}^{t}M_{s}+(1-e^{-1})\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}}\right)\frac{\delta}{d}\\
 & \le\delta.
\end{align*}

\end_inset

For the upper bound,
 we can prove:
 
\begin_inset Formula 
\[
\Maxeigen{\sum_{s=1}^{t}M_{s}-\left(e-1\right)\sum_{s=1}^{t}\CE{M_{s}}{\Fcal_{s-1}}}\le\log\frac{d}{\delta},
\]

\end_inset

in a similar manner,
 using the fact that 
\begin_inset Formula $e^{x}\le1+(e-1)x$
\end_inset

 for 
\begin_inset Formula $x\in[0,1]$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%------------------------------------
\end_layout

\begin_layout Plain Layout

% References
\end_layout

\begin_layout Plain Layout

%------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
vskip
\end_layout

\end_inset

 0.2in 
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "ref"

\end_inset


\end_layout

\end_body
\end_document
